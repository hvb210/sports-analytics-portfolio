/*!
 * v1.1.5 (c) 2025
 *
 * Includes:
 * - https://www.npmjs.com/package/bowser
 * - https://www.npmjs.com/package/delay
 * - https://www.npmjs.com/package/es6-error
 * - https://www.npmjs.com/package/es6-symbol
 * - https://www.npmjs.com/package/eventemitter3
 * - https://www.npmjs.com/package/json-stringify-safe
 * - https://www.npmjs.com/package/p-defer
 * - https://www.npmjs.com/package/p-finally
 * - https://www.npmjs.com/package/promise-queue
 * - https://www.npmjs.com/package/protochain
 * - https://www.npmjs.com/package/unfetch
 * - https://www.npmjs.com/package/upper-case-first
 */
!function(){Function.prototype.$asyncbind=function e(t,n){"use strict";function r(){return i.apply(t,arguments)}Function.prototype.$asyncbind||Object.defineProperty(Function.prototype,"$asyncbind",{value:e,enumerable:!1,configurable:!0,writable:!0}),e.trampoline||(e.trampoline=function(e,t,n,r,i){return function s(o){for(;o;){if(o.then)return o=o.then(s,r),i?void 0:o;try{if(o.pop){if(o.length)return o.pop()?t.call(e):o;o=n}else o=o.call(e)}catch(e){return r(e)}}}}),e.LazyThenable||(e.LazyThenable=function(){function e(e){return e&&e instanceof Object&&"function"==typeof e.then}function t(n,r,i){try{var s=i?i(r):r;if(n===s)return n.reject(new TypeError("Promise resolution loop"));e(s)?s.then(function(e){t(n,e)},function(e){n.reject(e)}):n.resolve(s)}catch(e){n.reject(e)}}function n(e){}function r(){}function i(n,i){var s=new r;try{this._resolver(function(r){return e(r)?r.then(n,i):t(s,r,n)},function(e){t(s,e,i)})}catch(e){t(s,e,i)}return s}function s(e){this._resolver=e,this.then=i}return r.prototype={resolve:n,reject:n,then:function(e,t){this.resolve=e,this.reject=t}},s.resolve=function(e){return s.isThenable(e)?e:{then:function(t){return t(e)}}},s.isThenable=e,s}(),e.EagerThenable=e.Thenable=(e.EagerThenableFactory=function(e){e=e||"object"==typeof process&&process.nextTick||"function"==typeof setImmediate&&setImmediate||function(e){setTimeout(e,0)};var t=function(){var t=[],n=0;function r(){for(;t.length-n;){try{t[n]()}catch(e){}t[n++]=void 0,1024===n&&(t.splice(0,1024),n=0)}}return function(i){t.push(i),t.length-n===1&&e(r)}}();function n(e){if(e){var t=this;e(function(e){t.resolve(e)},function(e){t.reject(e)})}}function r(e,t){if("function"==typeof e.y)try{var n=e.y.call(void 0,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function i(e,t){if("function"==typeof e.n)try{var n=e.n.call(void 0,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}return n.prototype={resolve:function(e){if(void 0===this.state){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var n=this;if(e&&("function"==typeof e||"object"==typeof e))try{var i=0,s=e.then;if("function"==typeof s)return void s.call(e,function(e){i++||n.resolve(e)},function(e){i++||n.reject(e)})}catch(e){return void(i||this.reject(e))}this.state=r,this.v=e,n.c&&t(function(){for(var t=0,i=n.c.length;t<i;t++)r(n.c[t],e)})}},reject:function(e){if(void 0===this.state){this.state=i,this.v=e;var n=this.c;n&&t(function(){for(var t=0,r=n.length;t<r;t++)i(n[t],e)})}},then:function(e,r){var i=new n,s={y:e,n:r,p:i};if(void 0===this.state)this.c?this.c.push(s):this.c=[s];else{var o=this.state,a=this.v;t(function(){o(s,a)})}return i}},n.resolve=function(e){if(e&&e instanceof n)return e;var t=new n;return t.resolve(e),t},n.reject=function(e){if(e&&e instanceof n)return e;var t=new n;return t.reject(e),t},n.version="2.3.3-nodent",n})());var i=this;switch(n){case!0:return new e.Thenable(r);case 0:return new e.LazyThenable(r);case void 0:return r.then=r,r;default:return function(){try{return i.apply(t,arguments)}catch(e){return n(e)}}}};var e,t,n,r,i,s,o,a,l=!1,u="1.1.5";function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function h(){return s?i:(s=1,i=(t?e:(t=1,e=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}))()?globalThis:function(){if(r)return n;r=1;var e=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};return n=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}()}())}var d,p,f,m,g,v,y,b,_,w,A,k,S,P,E,x,C,T,O,I,M,V,j,F,L,D,R,$,U,N,B,z,W,q,H,G,Q,Y,X,K,Z,J,ee,te,ne,re,ie,se,oe,ae,le={exports:{}};function ue(){return p?d:(p=1,d=function(e){return null!=e})}function ce(){if(T)return C;T=1;var e=(x?E:(x=1,E=function(){}))();return C=function(t){return t!==e&&null!==t}}function he(){return V||(V=1,M=(P?S:(P=1,S=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}))()?Object.keys:function(){if(I)return O;I=1;var e=ce(),t=Object.keys;return O=function(n){return t(e(n)?Object(n):n)}}()),M}function de(){return $?R:($=1,R=(k||(k=1,A=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),A)()?Object.assign:function(){if(D)return L;D=1;var e=he(),t=function(){if(F)return j;F=1;var e=ce();return j=function(t){if(!e(t))throw new TypeError("Cannot use null or undefined");return t}}(),n=Math.max;return L=function(r,i){var s,o,a,l=n(arguments.length,2);for(r=Object(t(r)),a=function(e){try{r[e]=i[e]}catch(e){s||(s=e)}},o=1;o<l;++o)e(i=arguments[o]).forEach(a);if(void 0!==s)throw s;return r},L}())}function pe(){return G||(G=1,H=function(){if(z)return B;z=1;var e="razdwatrzy";return B=function(){return"function"==typeof e.contains&&!0===e.contains("dwa")&&!1===e.contains("foo")}}()()?String.prototype.contains:function(){if(q)return W;q=1;var e=String.prototype.indexOf;return W=function(t){return e.call(this,t,arguments[1])>-1},W}()),H}function fe(){if(Q)return le.exports;Q=1;var e=ue(),t=function(){if(w)return _;w=1;var e=function(){if(b)return y;b=1;var e=function(){if(v)return g;v=1;var e=function(){if(m)return f;m=1;var e=ue(),t={object:!0,function:!0,undefined:!0};return f=function(n){return!!e(n)&&hasOwnProperty.call(t,typeof n)}}();return g=function(t){if(!e(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(e){return!1}}}();return y=function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(e){return!1}return!e(t)}}(),t=/^\s*class[\s{/}]/,n=Function.prototype.toString;return _=function(r){return!!e(r)&&!t.test(n.call(r))}}(),n=de(),r=function(){if(N)return U;N=1;var e=ce(),t=Array.prototype.forEach,n=Object.create;return U=function(r){var i=n(null);return t.call(arguments,function(t){e(t)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(t),i)}),i},U}(),i=pe(),s=le.exports=function(t,s){var o,a,l,u,c;return arguments.length<2||"string"!=typeof t?(u=s,s=t,t=null):u=arguments[2],e(t)?(o=i.call(t,"c"),a=i.call(t,"e"),l=i.call(t,"w")):(o=l=!0,a=!1),c={value:s,configurable:o,enumerable:a,writable:l},u?n(r(u),c):c};return s.gs=function(s,o,a){var l,u,c,h;return"string"!=typeof s?(c=a,a=o,o=s,s=null):c=arguments[3],e(o)?t(o)?e(a)?t(a)||(c=a,a=void 0):a=void 0:(c=o,o=a=void 0):o=void 0,e(s)?(l=i.call(s,"c"),u=i.call(s,"e")):(l=!0,u=!1),h={get:o,set:a,configurable:l,enumerable:u},c?n(r(c),h):h},le.exports}function me(){return X?Y:(X=1,Y=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])})}function ge(){if(Z)return K;Z=1;var e=me();return K=function(t){if(!e(t))throw new TypeError(t+" is not a symbol");return t}}function ve(){if(ee)return J;ee=1;var e=fe(),t=Object.create,n=Object.defineProperty,r=Object.prototype,i=t(null);return J=function(t){for(var s,o,a=0;i[t+(a||"")];)++a;return i[t+=a||""]=!0,n(r,s="@@"+t,e.gs(null,function(t){o||(o=!0,n(this,s,e(t)),o=!1)})),s}}ae||(ae=1,function(){if(a)return o;a=1;var e=h(),t={object:!0,symbol:!0};return o=function(){var n,r=e.Symbol;if("function"!=typeof r)return!1;n=r("test symbol");try{String(n)}catch(e){return!1}return!!t[typeof r.iterator]&&!!t[typeof r.toPrimitive]&&!!t[typeof r.toStringTag]}}()()||Object.defineProperty(h(),"Symbol",{value:function(){if(oe)return se;oe=1;var e,t,n,r=fe(),i=ge(),s=h().Symbol,o=ve(),a=function(){if(ne)return te;ne=1;var e=fe(),t=h().Symbol;return te=function(n){return Object.defineProperties(n,{hasInstance:e("",t&&t.hasInstance||n("hasInstance")),isConcatSpreadable:e("",t&&t.isConcatSpreadable||n("isConcatSpreadable")),iterator:e("",t&&t.iterator||n("iterator")),match:e("",t&&t.match||n("match")),replace:e("",t&&t.replace||n("replace")),search:e("",t&&t.search||n("search")),species:e("",t&&t.species||n("species")),split:e("",t&&t.split||n("split")),toPrimitive:e("",t&&t.toPrimitive||n("toPrimitive")),toStringTag:e("",t&&t.toStringTag||n("toStringTag")),unscopables:e("",t&&t.unscopables||n("unscopables"))})}}(),l=function(){if(ie)return re;ie=1;var e=fe(),t=ge(),n=Object.create(null);return re=function(r){return Object.defineProperties(r,{for:e(function(e){return n[e]?n[e]:n[e]=r(String(e))}),keyFor:e(function(e){var r;for(r in t(e),n)if(n[r]===e)return r})})},re}(),u=Object.create,c=Object.defineProperties,d=Object.defineProperty;if("function"==typeof s)try{String(s()),n=!0}catch(e){}else s=null;return t=function(n){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return e(n)},se=e=function e(i){var a;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return n?s(i):(a=u(t.prototype),i=void 0===i?"":String(i),c(a,{__description__:r("",i),__name__:r("",o(i))}))},a(e),l(e),c(t.prototype,{constructor:r(e),toString:r("",function(){return this.__name__})}),c(e.prototype,{toString:r(function(){return"Symbol ("+i(this).__description__+")"}),valueOf:r(function(){return i(this)})}),d(e.prototype,e.toPrimitive,r("",function(){var e=i(this);return"symbol"==typeof e?e:e.toString()})),d(e.prototype,e.toStringTag,r("c","Symbol")),d(t.prototype,e.toStringTag,r("c",e.prototype[e.toStringTag])),d(t.prototype,e.toPrimitive,r("c",e.prototype[e.toPrimitive])),se}(),configurable:!0,enumerable:!1,writable:!0}));const ye=-2;var be={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",AdMutedUnmutedPlayback:"AdMutedUnmutedPlayback"},_e=[be.AdLoaded,be.AdStarted,be.AdStopped,be.AdSkipped,be.AdImpression,be.AdVideoStart,be.AdVideoFirstQuartile,be.AdVideoMidpoint,be.AdVideoThirdQuartile,be.AdVideoComplete,be.AdError],we={initAd:"initAd",resizeAd:"resizeAd",startAd:"startAd",stopAd:"stopAd",pauseAd:"pauseAd",resumeAd:"resumeAd",expandAd:"expandAd",collapseAd:"collapseAd",skipAd:"skipAd"},Ae=[we.initAd,we.startAd,we.stopAd,we.skipAd],ke={adLinear:{defaultValue:!0},adWidth:{defaultValue:ye},adHeight:{defaultValue:ye},adExpanded:{defaultValue:!1},adSkippableState:{defaultValue:!1},adRemainingTime:{defaultValue:ye},adDuration:{defaultValue:ye},adVolume:{writable:!0,defaultValue:ye},adCompanions:{defaultValue:""},adIcons:{defaultValue:!1}},Se=[be.AdVideoStart,be.AdVideoFirstQuartile,be.AdVideoMidpoint,be.AdVideoThirdQuartile,be.AdVideoComplete],Pe=[be.AdStopped,be.AdError],Ee=e=>null!=e&&"function"==typeof e.then;Object.keys(be).map(e=>be[e]);var xe,Ce,Te,Oe,Ie={exports:{}},Me=(xe||(xe=1,Te=Ie.exports,Oe=function(){var e=!0;function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}var i,o=n(/(ipod|iphone|ipad)/i).toLowerCase(),a=!/like android/i.test(t)&&/android/i.test(t),l=/nexus\s*[0-6]\s*/i.test(t),u=!l&&/nexus\s*[0-9]+/i.test(t),c=/CrOS/.test(t),h=/silk/i.test(t),d=/sailfish/i.test(t),p=/tizen/i.test(t),f=/(web|hpw)(o|0)s/i.test(t),m=/windows phone/i.test(t),g=!m&&/windows/i.test(t),v=!o&&!h&&/macintosh/i.test(t),y=!a&&!d&&!p&&!f&&/linux/i.test(t),b=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),_=n(/version\/(\d+(\.\d+)?)/i),w=/tablet/i.test(t)&&!/tablet pc/i.test(t),A=!w&&/[^-]mobi/i.test(t),k=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:_||n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:e,version:n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||_}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:_||n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?i={name:"NAVER Whale browser",whale:e,version:n(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?i={name:"MZ Browser",mzbrowser:e,version:n(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:_||n(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?i={name:"Focus",focus:e,version:n(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:_||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:m?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},b?(i.msedge=e,i.version=b):(i.msie=e,i.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?i={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:b}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:n(/vivaldi\/(\d+(\.\d+)?)/i)||_}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e,i.osname="Firefox OS")):h?i={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:n(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:_||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:f?(i={name:"WebOS",osname:"WebOS",webos:e,version:_||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||_}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||_}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||_}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:a?i={name:"Android",version:_}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},_&&(i.version=_)):o?(i={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},_&&(i.version=_)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:n(/googlebot\/(\d+(\.\d+))/i)||_}:{name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&_&&(i.version=_)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||n(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!a&&!i.silk?!i.windowsphone&&o?(i[o]=e,i.ios=e,i.osname="iOS"):v?(i.mac=e,i.osname="macOS"):k?(i.xbox=e,i.osname="Xbox"):g?(i.windows=e,i.osname="Windows"):y&&(i.linux=e,i.osname="Linux"):(i.android=e,i.osname="Android");var S="";i.windows?S=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(n(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?S=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?S=(S=n(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):o?S=(S=n(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):a?S=n(/android[ \/-](\d+(\.\d+)*)/i):i.webos?S=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?S=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?S=n(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(S=n(/tizen[\/\s](\d+(\.\d+)*)/i)),S&&(i.osversion=S);var P=!i.windows&&S.split(".")[0];return w||u||"ipad"==o||a&&(3==P||P>=4&&!A)||i.silk?i.tablet=e:(A||"iphone"==o||"ipod"==o||a||l||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===s([i.version,"1.0"])||i.mzbrowser&&1===s([i.version,"6.0"])||i.focus&&1===s([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var n=t("undefined"!=typeof navigator&&navigator.userAgent||"");function r(e){return e.split(".").length}function i(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)r.push(t(e[n]));return r}function s(e){for(var t=Math.max(r(e[0]),r(e[1])),n=i(e,function(e){var n=t-r(e);return i((e+=new Array(n+1).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--t>=0;){if(n[0][t]>n[1][t])return 1;if(n[0][t]!==n[1][t])return-1;if(0===t)return 0}}function o(e,r,i){var o=n;"string"==typeof r&&(i=r,r=void 0),void 0===r&&(r=!1),i&&(o=t(i));var a=""+o.version;for(var l in e)if(e.hasOwnProperty(l)&&o[l]){if("string"!=typeof e[l])throw new Error("Browser version in the minVersion map should be a string: "+l+": "+String(e));return s([a,e[l]])<0}return r}return n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if("string"==typeof r&&r in n)return!0}return!1},n.isUnsupportedBrowser=o,n.compareVersions=s,n.check=function(e,t,n){return!o(e,t,n)},n._detect=t,n.detect=t,n},(Ce=Ie).exports?Ce.exports=Oe():Te.bowser=Oe()),Ie.exports),Ve=c(Me);const je=["dns-prefetch","preconnect","prefetch","preload"],Fe={},Le=je.reverse();(()=>{const e=document.createElement("link");e.relList&&e.relList.supports?je.forEach(t=>{Fe[t]=e.relList.supports(t)}):Object.assign(Fe,{"dns-prefetch":Ve.check({msie:"10",msedge:"12"},!0),prefetch:Ve.check({msie:"11",msedge:"12"},!0),preload:Ve.check({msedge:"17"},!0)})})();const De=e=>!!Fe[e];var Re=function(e,t,n){if(void 0===t&&(t=document),void 0===n&&(n=null),null==e||null==e.href||null==e.rel)return;if(e.rel=function(e,t){if(void 0===t&&(t=null),null==t){const n=Le.indexOf(e);n>=0&&(t=Le.slice(n+1))}if(null!=t){let n=0;for(;n<t.length&&!De(e);)e=t[n++]}return De(e)?e:null}(e.rel,n),null==e.rel)return;"dns-prefetch"===e.rel||"preconnect"===e.rel?(e.href=(e=>{const t=e.indexOf("//");if(t<0)return null;const n=e.indexOf("/",t+2);return n<0?e:e.substr(0,n)})(e.href),delete e.as,delete e.type):"prefetch"!==e.rel&&"preload"!==e.rel||(e.href=(e=>{const t=e.indexOf("#");return t<0?e:e.substr(0,t)})(e.href));const r=t.createElement("link");Object.assign(r,e),t.head.appendChild(r)},$e=()=>""+(1e9+Math.floor(9e9*Math.random()));const Ue=Symbol("name"),Ne=Symbol("view");class Be{constructor(e,t){let n,r;switch(void 0===t&&(t=null),typeof e){case"object":n=e.name,r=e.callback;break;case"string":n=e;break;case"function":r=e}null==n&&(n=`cb_${(new Date).getTime().toString(36)}${parseInt($e()).toString(16).substring(1)}`),this[Ue]=n,null!=t&&null!=t.defaultView&&(t=t.defaultView),this[Ne]=null!=t?t:window,null!=r&&(this.callback=r)}get name(){return this[Ue]}get exists(){return null!=this.callback}get callback(){return null!=this[Ne]&&"function"==typeof this[Ne][this.name]?this[Ne][this.name]:null}set callback(e){null!=this[Ne]&&(this[Ne][this.name]=e)}remove(){this.exists&&delete this[Ne][this.name]}invoke(){this.exists&&this.callback(...arguments)}}const ze=e=>null==e||""===(""+e).trim()||Array.isArray(e)&&null==e.length,We={vast:"vast",video:"video",vpaid:"vpaid",unknown:null},qe=/^(?:application|text)\/xml\+vast$/i,He=/^(?:application|text)\/(?:x-)?javascript$/i,Ge=/^video\//i,Qe=e=>{let{type:t,apiFramework:n}=e;return ze(n)&&qe.test(t)},Ye=e=>{let{type:t,apiFramework:n}=e;return"VPAID"===n&&He.test(t)},Xe=[{eval:Qe,result:We.vast},{eval:Ye,result:We.vpaid},{eval:e=>{let{type:t,apiFramework:n}=e;return ze(n)&&Ge.test(t)},result:We.video}],Ke=e=>Xe.reduce((t,n)=>n.eval(e)?n.result:t,We.unknown);var Ze,Je={},et={exports:{}},tt={exports:{}},nt={exports:{}};function rt(){if(Ze)return nt.exports;Ze=1;var e=nt.exports={version:"2.6.12"};return"number"==typeof __e&&(__e=e),nt.exports}var it,st,ot,at,lt,ut,ct,ht={exports:{}};function dt(){if(it)return ht.exports;it=1;var e=ht.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();return"number"==typeof __g&&(__g=e),ht.exports}function pt(){return ot?st:(ot=1,st=!1)}function ft(){if(at)return tt.exports;at=1;var e=rt(),t=dt(),n="__core-js_shared__",r=t[n]||(t[n]={});return(tt.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:e.version,mode:pt()?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"}),tt.exports}function mt(){if(ut)return lt;ut=1;var e=0,t=Math.random();return lt=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++e+t).toString(36))},lt}function gt(){if(ct)return et.exports;ct=1;var e=ft()("wks"),t=mt(),n=dt().Symbol,r="function"==typeof n;return(et.exports=function(i){return e[i]||(e[i]=r&&n[i]||(r?n:t)("Symbol."+i))}).store=e,et.exports}var vt,yt,bt,_t,wt,At,kt,St,Pt,Et,xt,Ct,Tt,Ot,It,Mt,Vt,jt,Ft,Lt,Dt,Rt,$t,Ut,Nt,Bt,zt,Wt,qt,Ht,Gt,Qt,Yt,Xt={};function Kt(){return yt?vt:(yt=1,vt=function(e){return"object"==typeof e?null!==e:"function"==typeof e})}function Zt(){if(_t)return bt;_t=1;var e=Kt();return bt=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}}function Jt(){return At?wt:(At=1,wt=function(e){try{return!!e()}catch(e){return!0}})}function en(){return St?kt:(St=1,kt=!Jt()(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))}function tn(){if(Et)return Pt;Et=1;var e=Kt(),t=dt().document,n=e(t)&&e(t.createElement);return Pt=function(e){return n?t.createElement(e):{}}}function nn(){if(It)return Xt;It=1;var e=Zt(),t=Ct?xt:(Ct=1,xt=!en()&&!Jt()(function(){return 7!=Object.defineProperty(tn()("div"),"a",{get:function(){return 7}}).a})),n=function(){if(Ot)return Tt;Ot=1;var e=Kt();return Tt=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}}(),r=Object.defineProperty;return Xt.f=en()?Object.defineProperty:function(i,s,o){if(e(i),s=n(s,!0),e(o),t)try{return r(i,s,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(i[s]=o.value),i},Xt}function rn(){return Vt?Mt:(Vt=1,Mt=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}})}function sn(){if(Ft)return jt;Ft=1;var e=nn(),t=rn();return jt=en()?function(n,r,i){return e.f(n,r,t(1,i))}:function(e,t,n){return e[t]=n,e},jt}function on(){return Nt?Ut:(Nt=1,Ut={})}function an(){return Gt?Ht:(Gt=1,Ht=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e})}function ln(){if(Yt)return Qt;Yt=1;var e=function(){if(qt)return Wt;qt=1;var e=function(){if(zt)return Bt;zt=1;var e={}.toString;return Bt=function(t){return e.call(t).slice(8,-1)}}();return Wt=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}}(),t=an();return Qt=function(n){return e(t(n))}}var un,cn,hn,dn,pn,fn,mn,gn,vn,yn,bn,_n,wn,An,kn,Sn,Pn,En,xn,Cn,Tn,On,In,Mn,Vn,jn,Fn,Ln,Dn,Rn,$n,Un,Nn,Bn,zn,Wn,qn,Hn,Gn,Qn,Yn,Xn,Kn,Zn,Jn,er,tr={exports:{}};function nr(){if(cn)return un;cn=1;var e={}.hasOwnProperty;return un=function(t,n){return e.call(t,n)},un}function rr(){if(pn)return tr.exports;pn=1;var e=dt(),t=sn(),n=nr(),r=mt()("src"),i=dn?hn:(dn=1,hn=ft()("native-function-to-string",Function.toString)),s="toString",o=(""+i).split(s);return rt().inspectSource=function(e){return i.call(e)},(tr.exports=function(i,s,a,l){var u="function"==typeof a;u&&(n(a,"name")||t(a,"name",s)),i[s]!==a&&(u&&(n(a,r)||t(a,r,i[s]?""+i[s]:o.join(String(s)))),i===e?i[s]=a:l?i[s]?i[s]=a:t(i,s,a):(delete i[s],t(i,s,a)))})(Function.prototype,s,function(){return"function"==typeof this&&this[r]||i.call(this)}),tr.exports}function ir(){if(wn)return _n;wn=1;var e=Math.ceil,t=Math.floor;return _n=function(n){return isNaN(n=+n)?0:(n>0?t:e)(n)}}function sr(){if(Tn)return Cn;Tn=1;var e=ft()("keys"),t=mt();return Cn=function(n){return e[n]||(e[n]=t(n))},Cn}function or(){return Vn?Mn:(Vn=1,Mn="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","))}function ar(){if(Fn)return jn;Fn=1;var e=function(){if(In)return On;In=1;var e=nr(),t=ln(),n=function(){if(xn)return En;xn=1;var e=ln(),t=function(){if(kn)return An;kn=1;var e=ir(),t=Math.min;return An=function(n){return n>0?t(e(n),9007199254740991):0}}(),n=function(){if(Pn)return Sn;Pn=1;var e=ir(),t=Math.max,n=Math.min;return Sn=function(r,i){return(r=e(r))<0?t(r+i,0):n(r,i)}}();return En=function(r){return function(i,s,o){var a,l=e(i),u=t(l.length),c=n(o,u);if(r&&s!=s){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((r||c in l)&&l[c]===s)return r||c||0;return!r&&-1}}}()(!1),r=sr()("IE_PROTO");return On=function(i,s){var o,a=t(i),l=0,u=[];for(o in a)o!=r&&e(a,o)&&u.push(o);for(;s.length>l;)e(a,o=s[l++])&&(~n(u,o)||u.push(o));return u},On}(),t=or();return jn=Object.keys||function(n){return e(n,t)}}function lr(){if(zn)return Bn;zn=1;var e=nn().f,t=nr(),n=gt()("toStringTag");return Bn=function(r,i,s){r&&!t(r=s?r:r.prototype,n)&&e(r,n,{configurable:!0,value:i})}}!function(){if(er)return Je;er=1;for(var e=function(){if(Jn)return Zn;Jn=1;var e=function(){if(Dt)return Lt;Dt=1;var e=gt()("unscopables"),t=Array.prototype;return null==t[e]&&sn()(t,e,{}),Lt=function(n){t[e][n]=!0},Lt}(),t=$t?Rt:($t=1,Rt=function(e,t){return{value:t,done:!!e}}),n=on(),r=ln();return Zn=function(){if(Kn)return Xn;Kn=1;var e=pt(),t=function(){if(bn)return yn;bn=1;var e=dt(),t=rt(),n=sn(),r=rr(),i=function(){if(vn)return gn;vn=1;var e=mn?fn:(mn=1,fn=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e});return gn=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)}}return function(){return t.apply(n,arguments)}},gn}(),s="prototype",o=function(a,l,u){var c,h,d,p,f=a&o.F,m=a&o.G,g=a&o.S,v=a&o.P,y=a&o.B,b=m?e:g?e[l]||(e[l]={}):(e[l]||{})[s],_=m?t:t[l]||(t[l]={}),w=_[s]||(_[s]={});for(c in m&&(u=l),u)d=((h=!f&&b&&void 0!==b[c])?b:u)[c],p=y&&h?i(d,e):v&&"function"==typeof d?i(Function.call,d):d,b&&r(b,c,d,a&o.U),_[c]!=d&&n(_,c,p),v&&w[c]!=d&&(w[c]=d)};return e.core=t,o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,yn=o}(),n=rr(),r=sn(),i=on(),s=function(){if(qn)return Wn;qn=1;var e=function(){if(Nn)return Un;Nn=1;var e=Zt(),t=function(){if(Dn)return Ln;Dn=1;var e=nn(),t=Zt(),n=ar();return Ln=en()?Object.defineProperties:function(r,i){t(r);for(var s,o=n(i),a=o.length,l=0;a>l;)e.f(r,s=o[l++],i[s]);return r},Ln}(),n=or(),r=sr()("IE_PROTO"),i=function(){},s="prototype",o=function(){var e,t=tn()("iframe"),r=n.length;for(t.style.display="none",function(){if($n)return Rn;$n=1;var e=dt().document;return Rn=e&&e.documentElement}().appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),o=e.F;r--;)delete o[s][n[r]];return o()};return Un=Object.create||function(n,a){var l;return null!==n?(i[s]=e(n),l=new i,i[s]=null,l[r]=n):l=o(),void 0===a?l:t(l,a)}}(),t=rn(),n=lr(),r={};return sn()(r,gt()("iterator"),function(){return this}),Wn=function(i,s,o){i.prototype=e(r,{next:t(1,o)}),n(i,s+" Iterator")}}(),o=lr(),a=function(){if(Yn)return Qn;Yn=1;var e=nr(),t=function(){if(Gn)return Hn;Gn=1;var e=an();return Hn=function(t){return Object(e(t))}}(),n=sr()("IE_PROTO"),r=Object.prototype;return Qn=Object.getPrototypeOf||function(i){return i=t(i),e(i,n)?i[n]:"function"==typeof i.constructor&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?r:null}}(),l=gt()("iterator"),u=!([].keys&&"next"in[].keys()),c="keys",h="values",d=function(){return this};return Xn=function(p,f,m,g,v,y,b){s(m,f,g);var _,w,A,k=function(e){if(!u&&e in x)return x[e];switch(e){case c:case h:return function(){return new m(this,e)}}return function(){return new m(this,e)}},S=f+" Iterator",P=v==h,E=!1,x=p.prototype,C=x[l]||x["@@iterator"]||v&&x[v],T=C||k(v),O=v?P?k("entries"):T:void 0,I="Array"==f&&x.entries||C;if(I&&(A=a(I.call(new p)))!==Object.prototype&&A.next&&(o(A,S,!0),e||"function"==typeof A[l]||r(A,l,d)),P&&C&&C.name!==h&&(E=!0,T=function(){return C.call(this)}),e&&!b||!u&&!E&&x[l]||r(x,l,T),i[f]=T,i[S]=d,v)if(_={values:P?T:k(h),keys:y?T:k(c),entries:O},b)for(w in _)w in x||n(x,w,_[w]);else t(t.P+t.F*(u||E),f,_);return _},Xn}()(Array,"Array",function(e,t){this._t=r(e),this._i=0,this._k=t},function(){var e=this._t,n=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,t(1)):t(0,"keys"==n?r:"values"==n?e[r]:[r,e[r]])},"values"),n.Arguments=n.Array,e("keys"),e("values"),e("entries"),Zn}(),t=ar(),n=rr(),r=dt(),i=sn(),s=on(),o=gt(),a=o("iterator"),l=o("toStringTag"),u=s.Array,c={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=t(c),d=0;d<h.length;d++){var p,f=h[d],m=c[f],g=r[f],v=g&&g.prototype;if(v&&(v[a]||i(v,a,u),v[l]||i(v,l,f),s[f]=u,m))for(p in e)v[p]||n(v,p,e[p],!0)}}();const ur=(e,t,n)=>{e.setAttribute(t,n)},cr=(e,t,n)=>{var r;e[t]=0===(r=(r=n).trim()).length?r:1===r.length?r.toLowerCase():r.replace(/(^[-_.]+)|([-_.]+$)/g,"").replace(/[-_.\s]+(\w)/g,(e,t)=>t.toUpperCase()).replace(/(\d+)(\w)/g,(e,t,n)=>t+n.toUpperCase())},hr=function(e,t,n){if(void 0===n&&(n=!1),null==e||null==e.style)return;const r="function"==typeof e.style.setProperty,i=n?"important":"";Object.keys(t).forEach(n=>{const s=t[n];r?e.style.setProperty(n,s,i):e.style[n]=s})},dr=function(e,t,n,r,i){return void 0===i&&(i=!1),function(e,t,n,r,i,s){void 0===s&&(s=!1);const o=e.createElementNS("http://www.w3.org/2000/svg",n);return null!=r&&((e,t)=>{const n="function"==typeof e.setAttribute?ur:cr;Object.keys(t).forEach(r=>{n(e,r,t[r])})})(o,r),null!=i&&hr(o,i,s),o}(e,0,t,n,r,i)};var pr,fr={exports:{}},mr=function(){if(pr)return fr.exports;pr=1;const e=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},t=t=>{let{clearTimeout:n,setTimeout:r,willResolve:i}=t;return function(t,s){let o,a,l,{value:u,signal:c}=void 0===s?{}:s;if(c&&c.aborted)return Promise.reject(e());const h=n||clearTimeout,d=()=>{h(o),l(e())},p=new Promise((e,n)=>{a=()=>{c&&c.removeEventListener("abort",d),i?e(u):n(u)},l=n,o=(r||setTimeout)(a,t)});return c&&c.addEventListener("abort",d,{once:!0}),p.clear=()=>{h(o),o=null,a()},p}},n=e=>{const n=t({...e,willResolve:!0});return n.reject=t({...e,willResolve:!1}),n.range=(e,t,r)=>n(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,t),r),n},r=n();return r.createWithTimers=n,fr.exports=r,fr.exports.default=r,fr.exports}(),gr=c(mr);const vr=()=>{};function yr(){const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}var br=(e,t)=>{const n=yr(),r=()=>{e.removeEventListener(t,r),n.resolve()};return e.addEventListener(t,r),n.promise.cancel=()=>{e.removeEventListener(t,r),n.reject(new Error("Canceled"))},n.promise};var _r=function(e){return new Promise(function(t,n){var r=function(e){return function(t){try{return i.cancel(),s.cancel(),e&&e.call(this,t)}catch(e){return n(e)}}.bind(this)}.bind(this);let i,s;if(void 0===e&&(e=document),null!=e.body)return t();var o,a;o=e,a="body",i=(()=>{const e=yr(),t=setInterval(()=>{null!=o[a]&&e.resolve()},20);return e.promise.cancel=()=>{clearInterval(t),e.reject(new Error("Canceled"))},e.promise})(),s=br(e,"DOMContentLoaded"),i.catch(vr),s.catch(vr);var l=function(){try{return t()}catch(e){return n(e)}},u=function(e){try{throw e}catch(e){return r(n)(e)}};try{return Promise.resolve(Promise.race([i,s])).then(function(e){try{return r(l)()}catch(e){return u(e)}},u)}catch(e){u(e)}})};const wr=e=>new Promise(function(t,n){var r;function i(){return null==e.contentWindow||null==e.contentWindow.document?Promise.resolve(gr(100)).then(function(e){try{return i}catch(e){return n(e)}},n):[1]}return(r=function(e){for(;e;){if(e.then)return void e.then(r,n);try{if(e.pop){if(e.length)return e.pop()?s.call(this):e;e=i}else e=e.call(this)}catch(e){return n(e)}}}.bind(this))(i);function s(){return t()}}),Ar=Symbol("data");class kr{constructor(){this[Ar]=Object.create(null)}_get(e){return this[Ar][e]}_put(e,t){this[Ar][e]=t}_putAll(e){const t=Object.keys(e);for(let n=0;n<t.length;++n){const r=t[n],i=e[r];this._put(r,i)}}}const Sr=Symbol("listeners");class Pr{constructor(){this[Sr]=[]}get count(){return this[Sr].length}add(e,t,n,r){return void 0===r&&(r=null),(e=>null!=e&&"function"==typeof e.addEventListener)(e)?(null!=r&&(n=n.bind(r)),e.addEventListener(t,n),this[Sr].push({target:e,type:t,listener:n}),this):this}addMany(e,t,n){return void 0===n&&(n=null),Object.keys(t).forEach(r=>this.add(e,r,t[r],n)),this}removeAll(){return this[Sr].splice(0).forEach(e=>{let{target:t,type:n,listener:r}=e;t.removeEventListener(n,r)}),this}}function Er(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var xr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=Er(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:n.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(n,n.constructor),Er(n)):(Object.defineProperty(n,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(t,e),t}(function(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));class Cr extends xr{constructor(e){super(e),this.name="CancelError"}}class Tr extends xr{constructor(){super("Guest VPAID not available"),this.name="GuestNotAvailableError"}}let Or=class extends xr{constructor(e,t,n,r){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),super(e),this.message=e,this.code=t,this.subject=r,this.cause=n}toString(){return"VAST error"+(null==this.code?"":` ${this.code}`)+(null==this.message||0===this.message.length?" (no error message)":`: ${this.message}`)}};class Ir extends Or{constructor(e){super(`Method "${e}" not available`,405),this.name="MethodNotAvailableError"}}const Mr=/\/js\/vpaid-transformer\/[^/]+\/[a-z0-9-]+\.js#/;let Vr=null;const jr=()=>(null==Vr&&(Vr=document.currentScript||(()=>{const e=document.querySelectorAll("script");let t=null,n=e.length-1;for(;n>=0&&null==t;){const r=e[n],{src:i}=r;null!=i&&Mr.test(i)&&(t=r),--n}return t})()),Vr),Fr=["caller","callee","arguments"],Lr=(e,t)=>{const n={enumerable:!1,writable:!1,value:e[t]};Object.defineProperty(e,t,n)},Dr=e=>{if(null==e||""===e)return null;if("undefined"!=typeof URL&&URL instanceof Function)return new URL(e).hostname;{const t=document.createElement("a");return t.href=e,t.hostname}},Rr=e=>t=>{for(t=""+t;t.length<e;)t="0"+t;return t},$r=Rr(2),Ur=Rr(3),Nr=e=>{const{domainLookupStart:t,domainLookupEnd:n,connectStart:r,connectEnd:i,secureConnectionStart:s,requestStart:o,responseStart:a,responseEnd:l}=e,u={dns:Math.round(n-t),tcpHandshake:Math.round(i-r),response:Math.round(l-a),requestStartUntilResponseEnd:Math.round(l-o)};return s>0&&(u.secureConnection=Math.round(i-s)),u},Br=e=>{const t=(e=>{let t=null;try{t=performance.getEntriesByType("resource").find(t=>{let{name:n}=t;return n===e})}catch(e){}return t})(e);return null==t?null:Nr(t)},zr=/^[^:]+:\/\/tpc\.googlesyndication\.com\/pagead\/js\/loader/,Wr=/^[^:]+:\/\/imasdk\.googleapis\.com\/js\/sdkloader\/vpaid_adapter\.js\b/,qr=e=>Wr.test(e);var Hr,Gr=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=document),new Promise((r,i)=>{const s=n.createElement("script");s.addEventListener("load",()=>r(s)),s.addEventListener("error",()=>i(new Or(`Failed to insert "${e}"`,405))),s.src=e,s.crossOrigin=t,n.getElementsByTagName("head")[0].appendChild(s)})},Qr=e=>{let t=0,n=null;return function(){if(0===t)try{for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];n=e.apply(this,i),t=1}catch(e){n=e,t=2}if(2===t)throw n;return n}},Yr=()=>(new Date).getTime(),Xr={exports:{}},Kr=Xr.exports,Zr=(Hr||(Hr=1,function(e){!function(t,n){e.exports?e.exports=n():t.Queue=n()}(Kr,function(){var e="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},t=function(){};function n(e,t,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==e?e:1/0,this.maxQueuedPromises=void 0!==t?t:1/0,this.queue=[]}return n.configure=function(t){e=t},n.prototype.add=function(n){var r=this;return new e(function(e,i,s){r.queue.length>=r.maxQueuedPromises?i(new Error("Queue limit reached")):(r.queue.push({promiseGenerator:n,resolve:e,reject:i,notify:s||t}),r._dequeue())})},n.prototype.getPendingLength=function(){return this.pendingPromises},n.prototype.getQueueLength=function(){return this.queue.length},n.prototype._dequeue=function(){var t=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n,r=this.queue.shift();if(!r)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,(n=r.promiseGenerator(),n&&"function"==typeof n.then?n:new e(function(e){e(n)})).then(function(e){t.pendingPromises--,r.resolve(e),t._dequeue()},function(e){t.pendingPromises--,r.reject(e),t._dequeue()},function(e){r.notify(e)})}catch(e){t.pendingPromises--,r.reject(e),t._dequeue()}return!0},n})}(Xr)),Xr.exports),Jr=c(Zr);function ei(e){return e.charAt(0).toUpperCase()+e.substr(1)}const ti=Symbol("plugins"),ni=Symbol("queue"),ri=Symbol("logger");class ii{constructor(){this[ti]=[],this[ni]=new Jr(1),this.dispose=Qr(this.dispose)}get plugins(){return this[ti].slice()}addPlugin(e){this[ti].push(e)}dispose(){return Promise.all(this._runStageHooks("dispose",[])).then(()=>this[ri].info("Plugin disposal finished"))}runPhase(e,t,n,r){return new Promise(function(i,s){return void 0===r&&(r=null),i(this[ni].add(()=>new Promise(function(i,s){return i(this._runPhase0(e,t,n,r))}.bind(this))))}.bind(this))}runPhaseSync(e,t,n,r){const i=ei(e);this._runStageHooks(`before${i}Sync`,t);const s=n(...t);return this._runStage(`after${i}`,[...t,s]).catch(r),s}_runPhase0(e,t,n,r){return new Promise(function(i,s){let o,a,l;if(null!=r&&r())return s(new Error(`Phase ${e} canceled`));o=ei(e);var u=function(){try{return a=n(...t),Promise.resolve(new Promise(function(e,t){return Ee(a)?Promise.resolve(a).then(e,t):e(a)})).then(function(e){try{return l=e,Promise.resolve(this._runStage(`after${o}`,[...t,a])).then(function(e){try{return i(l)}catch(e){return s(e)}},s)}catch(e){return s(e)}}.bind(this),s)}catch(e){return s(e)}}.bind(this),c=function(e){try{if(e instanceof Cr)return i(null);throw e}catch(e){return s(e)}};try{return Promise.resolve(this._runStage(`before${o}`,t)).then(function(e){try{return u()}catch(e){return c(e)}},c)}catch(e){c(e)}}.bind(this))}_runStage(e,t){return new Promise(function(n,r){return n(Promise.all(this._runStageHooks(e,t)))}.bind(this))}_runStageHooks(e,t){return this[ti].filter(t=>null!=t[e]).map(n=>n[e](...t)).filter(Ee)}}const si=function(e,t,n){void 0===n&&(n="Timed out");const r=gr.reject(t,{value:new Error(n)});return r.catch(vr),function(e,t){return new Promise(function(n,r){let i;void 0===t&&(t=()=>{});var s=function(e){try{return Promise.resolve(t()).then(function(t){try{throw e}catch(e){return r(e)}},r)}catch(e){return r(e)}};try{return Promise.resolve(e).then(function(e){try{return i=e,function(){try{return Promise.resolve(t()).then(function(e){try{return n(i)}catch(e){return r(e)}},r)}catch(e){return r(e)}}()}catch(e){return s(e)}},s)}catch(e){s(e)}})}(Promise.race([e,r]),()=>{r.clear()})};var oi=e=>{const t={};return Object.keys(e).filter(t=>null!=e[t]).forEach(n=>{t[n]=e[n]}),t};const ai={timestamp:()=>encodeURIComponent((e=>{const t=e.getTimezoneOffset(),n=Math.floor(t/60),r=(n<0?"+"+$r(-n):"-"+$r(n))+":"+$r(t%60);return e.getFullYear()+"-"+$r(e.getMonth()+1)+"-"+$r(e.getDate())+"T"+$r(e.getHours())+":"+$r(e.getMinutes())+":"+$r(e.getSeconds())+"."+Ur(e.getMilliseconds())+r})(new Date)),cachebusting:()=>(""+$e()).substring(0,8),errorcode:e=>{let{errorcode:t}=e;return null!=t?t:900},serverside:()=>"0",apiframeworks:()=>"2",vastversions:()=>"2,3,5,6,7,8,11,12,13,14",verificationvendors:()=>"",extensions:()=>""},li=/\[([A-Z_]+)]/g,ui=91,ci=92,hi=94,di=95,pi=e=>{const t={[ui]:e.dns,[ci]:e.tcpHandshake,[hi]:e.response,[di]:e.requestStartUntilResponseEnd};return e.secureConnectionStart>0&&(t[93]=e.secureConnectionStart),t},fi=Math.sqrt(2),mi=["video/3gpp"],gi={[We.vpaid]:1,[We.video]:2,[We.vast]:3},vi=e=>{let{width:t,height:n}=e;return t*n},yi=e=>e.reduce((e,t)=>vi(t)<vi(e)?t:e),bi=e=>e.reduce((e,t)=>vi(t)>vi(e)?t:e),_i=(e,t)=>{let{selector:n,filter:r}=t,i=null,s=0;for(;s<e.length&&null==i;){const t=e[s].filter(r);t.length>0&&(i=n(t)),++s}return i},wi=e=>e>0?e:1/0,Ai=(e,t,n,r)=>{const{probably:i=[],maybe:s=[]}=((e,t,n)=>{const r={};for(let n=0;n<e.length;++n){const{type:i}=e[n];Object.prototype.hasOwnProperty.call(r,i)||(r[i]=t.canPlayType(i))}const i={};for(let e=0;e<n.length;++e)i[n[e]]=[];for(let t=0;t<e.length;++t){const n=e[t],s=r[n.type];null!=i[s]&&i[s].push(n)}return i})(e,n,["probably",...r?["maybe"]:[]]);if(i.length+s.length===0)return null;let o=null,a=0;for(;a<t.length&&null==o;)o=_i([i,s],t[a]),++a;return o},ki={[We.vast]:e=>e[0],[We.vpaid]:e=>(e=>{const t=e.filter(Ye);return t.length>0?bi(t):null})(e),[We.video]:(e,t,n)=>{const r=e.filter(e=>{let{type:t}=e;return mi.indexOf(t)<0}),i=r.length>0?r:e;let s;return null!=n&&"function"==typeof n.canPlayType&&(s=Ai(i,t,n,!1)),null==s&&(s=Ai(i,t,document.createElement("video"),!0)),s}},Si=(e,t)=>gi[e]-gi[t];var Pi,Ei,xi,Ci={exports:{}},Ti=(Pi||(Pi=1,function(e){function t(e,t){var n=[],r=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(i,s){if(n.length>0){var o=n.indexOf(this);~o?n.splice(o+1):n.push(this),~o?r.splice(o,1/0,i):r.push(i),~n.indexOf(s)&&(s=t.call(this,i,s))}else n.push(s);return null==e?s:e.call(this,i,s)}}(e.exports=function(e,n,r,i){return JSON.stringify(e,t(n,i),r)}).getSerialize=t}(Ci)),Ci.exports),Oi=c(Ti),Ii=c(function(){if(xi)return Ei;function e(e){return null==e?null:Object.getPrototypeOf(Object(e))}return xi=1,Ei=function(t){for(var n=[],r=e(t);r;)n.push(r),r=e(r);return n}}());const Mi=e=>{if(null==e)return e;const t=Object.keys(e);if(1!==t.length||"message"!==t[0])return e;let n=e.message;return Array.isArray(n)&&1===n.length&&(n=n[0]),Mi(n)},Vi=(e,t)=>{let n,r;switch(typeof e){case"object":return null==e?e:null!=e.nodeType?`[DOM ${(e=>{if(null==e)return"null";if(1!==e.nodeType)return"node";try{let t=(e.nodeName||"unknown").toLowerCase();return null!=e.id&&(t+=`#${e.id}`),e.classList&&e.classList.length>0&&(t+="."+Array.from(e.classList).join(".")),t}catch(e){return"err"}})(e)}]`:t.indexOf(e)>=0?"[Circular]":(t.push(e),n=Array.isArray(e)?[]:{},r=Ii(e).filter(e=>e!==Object.prototype),Mi([e].concat(r).map(e=>Object.getOwnPropertyNames(e)).reduce((n,r)=>(r.forEach(r=>{try{e instanceof Error&&"stack"===r||(n[r]=Vi(e[r],t))}catch(e){n[r]=`[Error: ${e.message||e}]`}}),n),n)));case"function":if(t.length>0)return;return`[Function ${e.name||"anonymous"}]`;default:return e}},ji=e=>{try{const t=Vi(e,[])||e;switch(typeof t){case"string":return t;case"number":return""+t;default:return Oi(t)}}catch(e){return"[Error]"}},Fi=Yr(),Li=()=>Yr()-Fi,[Di,Ri]="undefined"!=typeof process?[process.env.LOG_LEVEL,process.env.NODE_ENV]:[];class $i{constructor(e,t){this._scope=e,this.level=t,this._init()}get scope(){return this._scope}get level(){return this._level}set level(e){this._level=e,this._levelIndex=$i.LEVELS.indexOf(this._level)}isAllowed(e){return $i.LEVELS.indexOf(e)>=this._levelIndex}formatArgs(e){const t=Date.now(),n=t-this._startTime,r=t-this._prevTime;return this._prevTime=t,(e=e.slice()).unshift(`(${n}, +${r})`),null!=this._scope&&e.unshift(this._scope+":"),e.join(" ")}_init(){var e=this;this._startTime="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing?window.performance.timing.navigationStart:Date.now(),this._prevTime=this._startTime;for(let t=0;t<$i.LEVELS.length;++t){const n=$i.LEVELS[t],r=function(){if(t>=e._levelIndex){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];console[n](e.formatArgs(i))}};Object.defineProperty(this,n,{value:r})}}}Object.defineProperty($i,"LEVELS",{value:["debug","log","info","warn","error"]});const Ui=new WeakMap;let Ni=0;const Bi=e=>"string"!=typeof e||0===e.length,zi=Symbol("runtime"),Wi=Symbol("init"),qi=Symbol("setGuest"),Hi=Symbol("ensureContainer"),Gi=Symbol("slot"),Qi=Symbol("videoSlot"),Yi=Symbol("phaser"),Xi=Symbol("pubSub"),Ki=Symbol("clickThroughUrl"),Zi=Symbol("adCompanions"),Ji=Symbol("options"),es=Symbol("internal"),ts=Symbol("adParameters");var ns=Object.freeze({__proto__:null,adCompanions:Zi,adParameters:ts,clickThroughUrl:Ki,ensureContainer:Hi,init:Wi,internal:es,options:Ji,phaser:Yi,pubSub:Xi,runtime:zi,setGuest:qi,slot:Gi,videoSlot:Qi});const rs=Symbol("config"),is=Symbol("logger");class ss{static get id(){throw new Error("Method is abstract")}static get defaultConfig(){return null}constructor(){this[is]=function(e,t){void 0===t&&(t={});const n=(e=>(null!=e&&"string"!=typeof e?(Ui.has(e)||Ui.set(e,Ni++),e=("function"==typeof e?e.name:e.constructor.name)+"@"+Ui.get(e)):"string"==typeof e&&(e=""+e),e))(e),r="test"===Ri?"error":"log",i=[t.level,Di,r].reduce((e,t)=>Bi(e)&&!Bi(t)?t:e);return new $i(n,i)}(this),this[rs]=null,this[zi]=null,this.dispose=Qr(this.dispose)}get runtime(){return this[zi]}get config(){return this[rs]}get host(){return this[zi].host}get hostInfo(){return this[zi].hostInfo}get guest(){return this[zi].guest}get logger(){return this[is]}init(){}dispose(){}publish(e,t){return void 0===t&&(t=[]),this[zi].publish(e,t,`plugin-${this.constructor.id}`)}track(){this[zi].track(...arguments)}trackPixel(e,t){this[zi].trackPixel(e,t)}trackError(){this[zi].trackError(...arguments)}setConfig(e){this[rs]=Object.assign({},this.constructor.defaultConfig,this[rs],e)}[Wi](e,t){if(null!=this[rs])throw new Error("Already configured");this[zi]=e,this.setConfig(t),this.init()}}const{init:os}=ns;class as extends ss{}const ls=Object.create(null);var us=new class{constructor(){this._contents=Object.create(null)}register(e){const t=e.id;if(null!=this._contents[t]&&this._contents[t]!==e)throw new Error(`Plugin "${t}" already registered`);this._provisionParent(t),this._contents[t]=e}create(e,t,n){if(null==this._contents[e])throw new Error(`Plugin "${e}" not registered`);const r=new(0,this._contents[e]);return r[os](n,t),r}_provisionParent(e){const t=e.indexOf(".");if(t<0)return;const n=e.substr(0,t);null==this._contents[n]&&(this._contents[n]=(e=>(null==ls[e]&&(ls[e]=class extends as{static get id(){return e}}),ls[e]))(n))}};const cs=Symbol("subscribers"),hs=Symbol("published"),ds=Symbol("options");class ps{constructor(e){void 0===e&&(e={}),this[cs]={},this[hs]=[],this[ds]=e}get published(){return this[hs]}get options(){return this[ds]}subscribe(e,t,n){void 0===n&&(n=null),null==this[cs][t]&&(this[cs][t]=[]),this[cs][t].push({fn:e,ctx:n})}unsubscribe(e,t){const n=this[cs][t];if(null!=n)for(let t=n.length-1;t>=0;--t)n[t].fn===e&&n.splice(t,1)}publish(e,t){if(void 0===t&&(t=[]),_e.indexOf(e)>=0&&this.didPublish(e))return;const n=this._normalizeEventArgs(e,t);if(this[hs].push({name:e,args:t}),null==this[cs][e])return;const r=this[cs][e].slice();for(let e=0;e<r.length;++e){const{fn:i,ctx:s}=r[e],o=null!=s&&!0===s[es];i.apply(s,o?t:n)}}didPublish(e){return this[hs].some(t=>{let{name:n}=t;return e===n})}_normalizeEventArgs(e,t){if(e===be.AdClickThru){const[e,n,r]=t;return["string"==typeof e?e:void 0,null!=n?n:"",null==r||!!r]}if(e===be.AdError){const[e,n]=t;return!0===this[ds].sendErrorInfo?[e,oi(n)]:[e]}return t}}const fs=10,ms=110,gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAAAXNCSVQI5gpbmQAAAApJREFUCB1jYAAAAAIAAc/INeUAAAAASUVORK5CYII=",vs="cdn.doubleverify.com",ys="rtb0.doubleverify.com",bs="https://c.amazon-adsystem.com/vfw/dv",_s="advm.js",ws=`https://${vs}/dvtp_src.js`,As=`https://${vs}/dvbs_src.js`,ks=`https://${vs}/dvbm.js`,Ss=`${bs}/advbm.js`,Ps=[{id:"boot",pattern:`${As}?`},{id:"src",pattern:`//${vs}/dvbs_src_internal`},{id:"verify",pattern:`//${ys}/verify.js?`}],Es={tagtype:"video",dvtagver:"6.1.src",tagformat:"2",msrapi:"jsVpaid",zjsver:u,omid:"0"},xs=["ctx","cmp","sid","plc","advid","crt","dup","adsrv","tagtype","omid"],Cs=Symbol("name"),Ts=Symbol("states"),Os=Symbol("infos"),Is=Symbol("state"),Ms=Symbol("initialState"),Vs=Symbol("timings");class js{constructor(e,t,n){void 0===t&&(t=0),void 0===n&&(n=void 0),this[Cs]=e,this[Ts]=[],this[Os]=[],this[Vs]=[],this[Ms]=t,this.set(t,n)}get name(){return this[Cs]}get state(){return this[Is]}getInfo(e){if(e<=this.state)return this[Os][e]}set(e,t){void 0===t&&(t=void 0);const n=this[Is];if(e<n)throw new Error(`Invalid ${this[Cs]} state change: ${n} â ${e}`);if(e!==n){this._ensureStates(e);for(let t=n+1;t<e;++t)this[Ts][t].resolve();this[Ts][e].resolve(t),this[Os][e]=t,this[Vs][e]=Yr(),this[Is]=e,this[Ms]}}maybeSet(e,t){return void 0===t&&(t=void 0),!this.reached(e)&&(this.set(e,t),!0)}reach(e){return new Promise(function(t,n){return this._ensureStates(e),t(this[Ts][e].promise)}.bind(this))}reached(e){return e<=this.state}time(e){return this[Vs][e]}timeBetween(e,t){if(e>t)throw new Error(`toState (${t}) must be greater than or equal to fromState (${e})`);return this.time(t)-this.time(e)}_ensureStates(e){for(let t=this[Ts].length;t<=e;++t)this[Ts].push(yr()),this[Os].push(void 0),this[Vs].push(void 0)}}const Fs=Symbol("facade"),Ls=Symbol("proxyCb");class Ds{constructor(e){this[Fs]=e,Re({href:`//${vs}`,rel:"preconnect",pr:"1.0"})}get facade(){return this[Fs]}get logger(){return this.facade.logger}start(){return new Promise(function(e,t){return this[Ls]=new Be(()=>this.facade.proxy),this.facade.config.adid=this[Ls].name,e()}.bind(this))}decide(){return new Promise(function(e,t){return e(3)})}enableDecisionTimeout(){return new Promise(function(e,t){return e()})}onStartCreativeLoad(){}dispose(){return new Promise(function(e,t){return null!=this[Ls]&&(this[Ls].remove(),this[Ls]=null),e()}.bind(this))}_getFalconUri(e){return"amazon"===e.proxy?Ss:"1"===e.falcondvtechcdn?"https://cdn.dv.tech/dvbm.js":ks}_insertScript(e){return new Promise(function(t,n){let r,i,s,o;return void 0===e&&(e=Gr),r=this._getConfig(xs),i=this._getScriptUri(r),s=this._getDelimiter(r),o=`${i}${s}${(e=>{const t=Object.keys(e);if(0===t.length)return"";let n=encodeURIComponent(t[0])+"="+encodeURIComponent(e[t[0]]);for(let r=1;r<t.length;++r)n+="&"+encodeURIComponent(t[r])+"="+encodeURIComponent(e[t[r]]);return n})(r)}`,Promise.resolve(e(o,void 0,void 0)).then(function(e){try{return t()}catch(e){return n(e)}},n)}.bind(this))}_getScriptUri(e){throw new Error("Not implemented")}_getDelimiter(e){throw new Error("Not implemented")}_getConfig(e){let t;if(null!=e){t={},e.forEach(e=>{null!=this.facade.config[e]&&(t[e]=this.facade.config[e])});for(const n in this.facade.config)Object.prototype.hasOwnProperty.call(this.facade.config,n)&&!e.includes(n)&&(t[n]=this.facade.config[n])}else t=this.facade.config;return t}}const Rs=Symbol("state"),$s=Symbol("recommendationFromDvCb"),Us=Symbol("ackConfirmationFromDvCb"),Ns=Symbol("timedOut"),Bs=Symbol("shouldAcknowledge"),zs=Symbol("timingMonitorInterval"),Ws=Symbol("timingMonitorSeen"),qs=(e,t)=>e.startsWith("//")?t.startsWith(`https:${e}`)||t.startsWith(`http:${e}`):t.startsWith(e);class Hs extends Ds{constructor(e){super(e),this[Rs]=new js("blocking-state"),this[$s]=null,this[Us]=null,this[Ns]=!1,this[Bs]=!1,this._scheduleAndProcessRecommendationTimeout=Qr(this._scheduleAndProcessRecommendationTimeout),Re({href:`//${ys}`,rel:"preconnect",pr:"1.0"}),Re({href:"//tps.doubleverify.com",rel:"preconnect",pr:"1.0"})}start(e){return new Promise(function(t,n){return void 0===e&&(e=Gr),Promise.resolve(this.$super$1("start").call(this)).then(function(r){try{return this[$s]=new Be(this._processRecommendationFromDv.bind(this)),this.facade.config.DVP_DCB=this[$s].name,this[Rs].set(1),this._startTimingMonitor(),Promise.resolve(this._insertScript(e)).then(function(e){try{return this._processTimings(),t()}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this),n)}.bind(this))}_getDelimiter(e){return"1"===e.falcon?"#":"?"}_getScriptUri(e){return"1"===e.falcon||null!=e.proxy?super._getFalconUri(e):As}onStartCreativeLoad(e){null==e||null!=e.poster&&""!==e.poster||(e.poster=gs)}decide(){return new Promise(function(e,t){return e(this[Rs].reach(2))}.bind(this))}enableDecisionTimeout(){return new Promise(function(e,t){return this._scheduleAndProcessRecommendationTimeout(),e()}.bind(this))}dispose(){return new Promise(function(e,t){if(this[Rs].reached(1))return Promise.resolve(this.enableDecisionTimeout()).then(function(e){try{if(this[Bs]&&!this[Rs].reached(3))return Promise.resolve(this[Rs].reach(3)).then(function(e){try{return r.call(this)}catch(e){return t(e)}}.bind(this),t);function r(){return n.call(this)}return r.call(this)}catch(i){return t(i)}}.bind(this),t);function n(){return null!=this[$s]&&(this[$s].remove(),this[$s]=null),null!=this[Us]&&(this[Us].remove(),this[Us]=null),this._processTimings(),this._disposeTimingMonitor(),Promise.resolve(this.$super$1("dispose").call(this)).then(function(n){try{return e()}catch(e){return t(e)}},t)}return n.call(this)}.bind(this))}_getBlockingTimeout(){const{blkto:e}=this.facade.config,t=null!=e?parseInt(e,10):900;return isNaN(t)?900:Math.min(Math.max(t,100),3e3)}_scheduleAndProcessRecommendationTimeout(){return new Promise(function(e,t){let n,r,i;return Promise.resolve(this[Rs].reach(1)).then(function(s){try{if(n=this[Rs].time(1),r=this._getBlockingTimeout(),i=n+r-Yr(),i>0)return Promise.resolve(gr(i)).then(function(e){try{return o.call(this)}catch(e){return t(e)}}.bind(this),t);function o(){return this[Ns]=this[Rs].maybeSet(2,"block"===this.facade.config.blktoa?1:2),this[Ns]&&(this.facade.timedOut=this[Ns]),e()}return o.call(this)}catch(a){return t(a)}}.bind(this),t)}.bind(this))}_processRecommendationFromDv(e,t){this[Bs]=!0,this[Rs].maybeSet(2,e),this._sendRecommendationAckToDv(t,Yr())}_sendRecommendationAckToDv(e,t){return new Promise(function(n,r){let i,s,o,a,l,u;return Promise.resolve(new Promise(function(e,t){return this.facade.creative.reached(3)?e([!1,!1]):Promise.resolve(Promise.race([this.facade.decide().then(e=>!!e&&this.facade.creative.reach(1).then(()=>!0)),this.facade.creative.reach(3).then(()=>!1)])).then(function(n){try{return e([n,!this[Ns]])}catch(e){return t(e)}}.bind(this),t)}.bind(this))).then(function(c){try{[i,s]=c,o=this.facade.creative.time(1)||-1,a=this.facade.creative.time(2)||-1,l=yr(),this[Us]=new Be(()=>{l.resolve()}),u=[i,s,o,a,t,this[Us].name];var h=function(){try{return this[Rs].set(3),n()}catch(e){return r(e)}}.bind(this),d=function(e){try{return h()}catch(e){return r(e)}};try{return new Be(e).invoke(...u),Promise.resolve(Promise.race([l.promise,gr(500)])).then(function(e){try{return h()}catch(e){return d()}},d)}catch(e){d()}}catch(e){return r(e)}}.bind(this),r)}.bind(this))}_startTimingMonitor(){this[Ws]=Ps.map(()=>!1),this[zs]=setInterval(this._processTimings.bind(this),250)}_disposeTimingMonitor(){null!=this[zs]&&(clearInterval(this[zs]),this[zs]=null,this[Ws]=null)}_processTimings(){let e;try{e=performance.getEntriesByType("resource")}catch(e){return void this._disposeTimingMonitor()}for(let t=0;t<e.length;++t){const n=e[t];for(let e=0;e<Ps.length;++e){const{id:t,pattern:r}=Ps[e];null!=this[Ws]&&!this[Ws][e]&&qs(r,n.name)&&(this[Ws][e]=!0,this.facade.onScriptResourceTiming(`dvbs-${t}`,n))}}null!=this[Ws]&&this[Ws].every(Boolean)&&this._disposeTimingMonitor()}$super$1(e){return super[e]}}class Gs extends Ds{start(e){return new Promise(function(t,n){return void 0===e&&(e=Gr),Promise.resolve(this.$super$1("start").call(this)).then(function(r){try{return Promise.resolve(this.facade.creative.reach(1)).then(function(r){try{return Promise.resolve(this._insertScript(e)).then(function(e){try{return t()}catch(e){return n(e)}},n)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this),n)}.bind(this))}_getDelimiter(e){return"#"}_getScriptUri(e){if("1"===e.falcon)return super._getFalconUri(e);if(null==e.proxy)return ws;if(null!=e.static)return`${e.static}/${_s}`;const t=e.dvmver;return null!=t?`${bs}/advm/${t}/${_s}`:`${bs}/${_s}`}$super$1(e){return super[e]}}var Qs=e=>new(e.blockingEnabled?Hs:Gs)(e);const Ys=Symbol("logger"),Xs=Symbol("config"),Ks=Symbol("proxy"),Zs=Symbol("mode"),Js=Symbol("decision"),eo=Symbol("createMode"),to=Symbol("timedOut"),no=Symbol("creativeState");class ro{constructor(e){void 0===e&&(e=Qs),this[no]=new js("dvf-creative"),this[Js]=yr(),this[eo]=e,this[Zs]=null,this[to]=!1,this.start=Qr(this.start),this._determineDecision=Qr(this._determineDecision),this.dispose=Qr(this.dispose)}get logger(){return this[Ys]}get blockingEnabled(){return"1"===this[Xs].blk}get dryRun(){return"1"===this[Xs].dry}get timedOut(){return this[to]}set timedOut(e){this[to]=e}get creative(){return this[no]}get config(){return this[Xs]}get proxy(){return this[Ks]}start(e,t){return new Promise(function(n,r){this[Ks]=t,this[Xs]=this._createMeasurementModeConfig(e);var i=function(){try{return n()}catch(e){return r(e)}},s=function(e){try{return this[Js].reject(e),i()}catch(e){return r(e)}}.bind(this);try{return this[Zs]=this[eo](this),Promise.resolve(this[Zs].start()).then(function(e){try{return i()}catch(e){return s(e)}},s)}catch(e){s(e)}}.bind(this))}decide(){return new Promise(function(e,t){return null==this[Zs]?t(new Error("Not started yet")):(this._awaitAndResolveDecision(),e(this[Js].promise))}.bind(this))}decideWithTimeout(){return new Promise(function(e,t){return null==this[Zs]?t(new Error("Not started yet")):(this[Zs].enableDecisionTimeout(),e(this.decide()))}.bind(this))}onStartCreativeLoad(e){null!=this[Zs]&&this[Zs].onStartCreativeLoad(e),this.creative.maybeSet(1)}onEndCreativeLoad(){this.creative.maybeSet(2)}onScriptResourceTiming(e,t){const n={91:e},r=Nr(t),i=pi(r);this.track("timing",n,i)}dispose(){return new Promise(function(e,t){if(this.creative.maybeSet(3),null!=this[Zs])return Promise.resolve(this[Zs].dispose()).then(function(e){try{return this[Zs]=null,n.call(this)}catch(e){return t(e)}}.bind(this),t);function n(){return e()}return n.call(this)}.bind(this))}_awaitAndResolveDecision(){return new Promise(function(e,t){let n;return Promise.resolve(this[Zs].decide()).then(function(r){try{return n=1!==r||this.dryRun,this[Js].resolve(n),e()}catch(e){return t(e)}}.bind(this),t)}.bind(this))}_createMeasurementModeConfig(e){const t=Object.assign({},e,Es);return null!=e.dvtagver&&(t.dvtagver=e.dvtagver),t}track(){}}const io=Symbol("plugin"),so=Symbol("disposed"),{slot:oo,videoSlot:ao}=ns;class lo{constructor(e){if(null==e)throw new Error("Must specify the plugin");this[io]=e,this[so]=!1}dispose(){this[so]=!0}getAdVolume(){return this._genericCall("getAdVolume",()=>this[io].host.getAdVolume(),-1)}getAdDuration(){return this._genericCall("getAdDuration",()=>this[io].host.getAdDuration(),-1)}subscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._genericCall("subscribe",()=>this[io].host.subscribe(...t))}unsubscribe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._genericCall("unsubscribe",()=>this[io].host.unsubscribe(...t))}getPlayer(){return this._genericCall("getPlayer",()=>this[io][ao])}getSlot(){return this._genericCall("getSlot",()=>this[io][oo])}getPreviousEvents(){return this._genericCall("getPreviousEvents",()=>this[io].runtime.hostInfo.publishedEvents.map(e=>{let{name:t}=e;return t}),[])}_genericCall(e,t,n){if(void 0===n&&(n=void 0),this[so]);else try{return t()}catch(e){}return n}}const uo=Symbol("dvFacade"),co=Symbol("videoSlotOriginalPoster"),{slot:ho,videoSlot:po}=ns,fo=Symbol("domEventTracker"),mo=Symbol("initialVideoSource"),go=e=>"currentSrc"in e?e.currentSrc:e.src,vo=["dns","tcpHandshake","secureConnection","response","requestStartUntilResponseEnd"],yo=e=>null!=e?vo.map(t=>{return"number"==typeof(n=e[t])?n:"";var n}).join(":"):"",bo=e=>e.map(e=>e.timings).map(yo).join(","),_o=e=>new Promise((t,n)=>{const r=new XMLHttpRequest;r.onload=()=>{if(r.status<200||r.status>=300)n(new Error(`HTTP ${r.status}`));else{const e=r.status,n=(e=>{const t={};let n=null;try{n=e.getResponseHeader("content-type")}catch(e){}return null!=n&&(t["content-type"]=n),t})(r),i=(e=>({text:e.responseText,xml:e.responseXML}))(r);t({statusCode:e,headers:n,body:i})}},r.onerror=()=>{n(new Error("Unknown error"))},r.open("GET",e),r.send()});class wo extends xr{constructor(e,t,n){super(e),this.vastUrl=t,this.wrapperCount=n}}const Ao=(e,t)=>Array.prototype.find.call(e.childNodes,e=>e.localName===t),ko=(e,t)=>new Promise(function(n,r){let i;var s;function o(){if(!(null!=e&&i++<5))return[1];{let s,a;s={url:e},t.push(s),s.startTime=Yr();var n=function(t){try{throw new wo(t.message,e,i)}catch(e){return r(e)}};try{return Promise.resolve((e=>new Promise(function(t,n){let r,i;return Promise.resolve(_o(e)).then(function(e){try{if(({headers:r,body:{xml:i}}=e),null==i||null==i.documentElement||"VAST"!==i.documentElement.localName){let e;return e=r["content-type"]||"unknown",n(new Error(`Invalid response: ${e}`))}return t(i)}catch(e){return n(e)}},n)}))(e)).then(function(t){try{return a=t,function(){try{s.endTime=Yr(),s.timings=Br(e);try{e=(e=>{const t=Ao(e.documentElement,"Ad");if(null==t)throw new Error("No ads");if(null!=Ao(t,"InLine"))return null;const n=Ao(t,"Wrapper");if(null==n)throw new Error("No InLine or Wrapper");const r=Ao(n,"VASTAdTagURI");if(null==r)throw new Error("No VASTAdTagURI");return r.textContent.trim()})(a)}catch(t){throw new wo(t.message,e,i)}return o}catch(e){return r(e)}}()}catch(e){return n(e)}},n)}catch(e){n(e)}}}return i=0,(s=function(e){for(;e;){if(e.then)return void e.then(s,r);try{if(e.pop){if(e.length)return e.pop()?a.call(this):e;e=o}else e=e.call(this)}catch(e){return r(e)}}}.bind(this))(o);function a(){return null!=e?r(new wo("Wrapper limit exceeded",e,i)):n()}}),So=9,Po=102,Eo=9;us.register(class extends ss{static get id(){return"dv"}static get defaultConfig(){return{falcon:"0",mon:"1",blk:"0"}}constructor(){super(),this[uo]=new ro,this[uo].track=this.track.bind(this)}init(){this[uo].start(this.config,new lo(this))}dispose(){return this[uo].dispose()}beforeInitAd(e,t,n,r,i,s){return new Promise(function(e,t){const{slot:n,videoSlot:r}=s;return this[ho]=n,this[po]=r,this[co]=null!=r?r.poster:null,this[uo].onStartCreativeLoad(this[po]),this._awaitAndHandleBlockDecision(),e()}.bind(this))}beforeAdLoaded(){return new Promise(function(e,t){let n;return this[uo].onEndCreativeLoad(),Promise.resolve(this[uo].decideWithTimeout()).then(function(r){try{return n=r,n?e():t(new Error("Ad blocked"))}catch(e){return t(e)}},t)}.bind(this))}_awaitAndHandleBlockDecision(){return new Promise(function(e,t){let n,r,i,s;return this.runtime.tracking.addMetric(118,()=>this[uo].config.blkto),n=Li(),this.runtime.tracking.addMetric(119,()=>n),Promise.resolve(this[uo].decide()).then(function(n){try{if(r=n,i=Li(),this.runtime.tracking.addMetric(120,()=>i),s=this[uo].timedOut?"timeout":"decision",this.track(r?"dv-res-allow":"dv-res-block",{197:s},null),r)null!=this[po]&&this[po].poster===gs&&(this[po].poster=this[co]);else{let e,t;e="Ad blocked",t={message:e},this.publish(be.AdError,[e,t])}return e()}catch(e){return t(e)}}.bind(this),t)}.bind(this))}}),us.register(class extends ss{constructor(){super(),this[fo]=new Pr,this[mo]=null}static get id(){return"quirk.early-start"}beforeInitAd(e,t,n,r,i,s){return new Promise(function(e,t){if(null==s)return e();const{videoSlot:n}=s;if(null==n)return e();this[mo]=go(n);const r=this._preventEarlyPlayback.bind(this);return this[fo].addMany(n,{loadedmetadata:r,loadeddata:r,canplay:r,canplaythrough:r,playing:r}),e()}.bind(this))}beforeStartAd(){this[fo].removeAll()}dispose(){super.dispose(),this[fo].removeAll()}_preventEarlyPlayback(){const{videoSlot:e}=this.runtime.hostInfo;!e.paused&&this._hasVideoSourceChanged()&&e.pause()}_hasVideoSourceChanged(){const{videoSlot:e}=this.runtime.hostInfo;return go(e)!==this[mo]}}),us.register(class extends ss{static get id(){return"unwrapper-benchmark"}init(){return new Promise(function(e,t){return this._vastUrl=this.config.vastUrl,this._strategies=this.config.strategies,this._dimensions={[So]:"warmup",[Po]:this._vastUrl},this._metrics={[Eo]:this.config.originChainLength},this._runStrategies(),e()}.bind(this))}_runStrategies(){return new Promise(function(e,t){let n;n=this._strategies.slice(),(e=>{for(let t=e.length-1;t>0;--t){const n=Math.floor(Math.random()*t),r=e[t];e[t]=e[n],e[n]=r}})(n);var r=function(){try{return this._trackBenchmarkSuccess(),e()}catch(e){return t(e)}}.bind(this),i=function(n){try{return e()}catch(e){return t(e)}};try{return Promise.resolve(Promise.all(n.map(this._runStrategy.bind(this)))).then(function(e){try{return r()}catch(e){return i()}},i)}catch(e){i()}}.bind(this))}_runStrategy(e){return new Promise(function(t,n){let r;r=this._buildVastUrl(e),e.chain=[];var i=function(){try{var i=function(t){try{throw this._trackBenchmarkError(e.name,t),t}catch(e){return n(e)}}.bind(this);try{let s;return s=Yr(),Promise.resolve(ko(r,e.chain)).then(function(r){try{return e.totalTime=Yr()-s,function(){try{return t()}catch(e){return n(e)}}()}catch(e){return i(e)}},i)}catch(e){i(e)}}catch(e){return n(e)}}.bind(this),s=function(e){try{return i()}catch(e){return n(e)}};try{return Promise.resolve(this._warmUp(r)).then(function(e){try{return i()}catch(e){return s()}},s)}catch(e){s()}}.bind(this))}_buildVastUrl(e){if(null==e.endpoint)return this._vastUrl;const t=encodeURIComponent(this._vastUrl);return`https://${e.endpoint}/1?t=vast&src=${t}`}_warmUp(e){return new Promise(function(t,n){let r;return r=(e=>{const t=e.indexOf("//");if(t<0)return null;const n=e.indexOf("/",t+2);return n<0?e:e.substr(0,n)})(e),Promise.resolve(_o(r)).then(function(e){try{return t()}catch(e){return n(e)}},n)})}_trackBenchmarkSuccess(){for(let e=0;e<this._strategies.length;++e){const t=10*(e+1),n=this._strategies[e];this._addSuccessDimensions(t,n),this._addSuccessMetrics(t,n)}this.track("benchmark-end",this._dimensions,this._metrics,!0)}_trackBenchmarkError(e,t){this._dimensions[10]=e,this._dimensions[110]=ji(t),null!=t.vastUrl&&(this._dimensions[102]=Dr(t.vastUrl),this._metrics[8]=t.wrapperCount),this.track("benchmark-error",this._dimensions,this._metrics,!0)}_addSuccessDimensions(e,t){let{name:n,chain:r}=t;Object.assign(this._dimensions,{[e]:n,[e+1]:r.map(e=>e.endTime-e.startTime).join(","),[e+2]:r.map(e=>Dr(e.url)).join(","),[e+3]:bo(r)})}_addSuccessMetrics(e,t){let{chain:n,totalTime:r}=t;Object.assign(this._metrics,{[e]:r,[e+1]:n.length});const i=n[0].timings;if(null!=i)for(let t=0;t<vo.length;++t){const n=i[vo[t]];"number"==typeof n&&(this._metrics[e+2+t]=n)}}});const xo="[debug] ",Co=Object.keys(ke);class To extends ss{static get id(){return"debug"}}const Oo=e=>{const t=ei(e),n=`before${t}`,r=`after${t}`;Object.assign(To.prototype,{[n]:function(){var e=arguments;return new Promise(function(t,r){for(var i=e.length,s=new Array(i),o=0;o<i;o++)s[o]=e[o];return console.log(`${xo}${n}`,...s),t()})},[r]:function(){var e=arguments;return new Promise(function(t,n){for(var i=e.length,s=new Array(i),o=0;o<i;o++)s[o]=e[o];return s.pop(),console.log(`${xo}${r}`,...s),t()})}})},Io=e=>{for(let t=0;t<e.length;++t)Oo(e[t])};Io(Object.keys(we).map(e=>we[e])),Io(Object.keys(be).map(e=>be[e])),Io(Co.map(e=>"set"+ei(e)));for(let e=0;e<Co.length;++e){const t=Co[e],n="afterGet"+ei(t);let r;To.prototype[n]=function(){var e;const n=(e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e];r!==n&&(console.log(`${xo}${t}:`,r,"â",n),r=n)}}us.register(To);const Mo=Symbol("play"),Vo=Symbol("skip"),jo=Symbol("interval"),Fo={position:"absolute",bottom:"10%",right:"0px",padding:"12px","z-index":"10000001","background-color":"rgba(0, 0, 0, 0.7)",color:"white","font-size":"12px","font-weight":"200","font-family":"Arial, Helvetica, sans-serif","border-color":"rgba(255, 255, 255, 0.5)","border-width":"0px","border-style":"solid",cursor:"default","user-select":"none"},Lo=Object.assign({},Fo,{"font-size":"18px","border-width":"1px 0px 1px 1px",cursor:"pointer"});us.register(class extends ss{constructor(){super(),this[Mo]=null}static get id(){return"play"}_createPlay(e){const t=e.ownerDocument||document,n=dr(t,"svg",{width:"100%",height:"100%",viewBox:"0 0 100 100"},{display:"none",position:"absolute","z-index":"10000001","background-color":"rgba(0, 0, 0, 0.3)",cursor:"pointer"},!0),r=dr(t,"circle",{cx:"50%",cy:"50%",r:"25%",fill:"none",stroke:"white","stroke-width":"2px"},!0);n.appendChild(r);const i=dr(t,"polygon",{points:"45,40,45,60,60,50",fill:"white"},!0);n.appendChild(i),this[Mo]=n,e.appendChild(n),n.addEventListener("click",()=>{this.host.resumeAd()})}_isEnabled(){const{acceptMedia:e}=this.config,{type:t}=this.runtime.guestInfo.mediaFile;let n=!0;if("string"==typeof e&&"string"==typeof t)try{n=new RegExp(e).test(t)}catch(e){}return n}beforeInitAd(e,t,n,r,i,s){return new Promise(function(e,t){return this._isEnabled()&&this._createPlay(s.slot),e()}.bind(this))}afterAdPaused(){return new Promise(function(e,t){return null!==this[Mo]&&hr(this[Mo],{display:"block"},!0),e()}.bind(this))}beforeAdPlaying(){return new Promise(function(e,t){return null!==this[Mo]&&hr(this[Mo],{display:"none"},!0),e()}.bind(this))}}),us.register(class extends ss{constructor(){super(),this[Vo]=null,this[jo]=null}static get id(){return"skip"}_createSkip(e){const t=(e.ownerDocument||document).createElement("div");t.addEventListener("click",()=>this._maybeSkip()),this[Vo]=t,this._updateSkip(),e.appendChild(t)}_updateSkip(){const e=this._getSkipTimeRemaining(),t=!isNaN(e)||this.host.getAdSkippableState();hr(this[Vo],{display:t?"block":"none"},!0);const n=e>0;let r="Skip ad";n&&(r="You can skip to video in [T]".replace("[T]",""+Math.round(e))),this[Vo].innerHTML!==r&&(this[Vo].innerHTML=r),hr(this[Vo],n?Fo:Lo,!0)}_getSkipTimeRemaining(){const{skipOffset:e}=this.runtime.config;if("number"!=typeof e)return NaN;const t=this.host.getAdDuration(),n=this.host.getAdRemainingTime();return t<0||n<0?NaN:e-Math.max(t-n,0)}_maybeSkip(){return new Promise(function(e,t){return this._getSkipTimeRemaining()>0?e():!0===this.guest.getAdSkippableState()?(this.host.skipAd(),n.call(this)):Promise.resolve(this.publish("AdSkipped")).then(function(e){try{return this.host.stopAd(),n.call(this)}catch(e){return t(e)}}.bind(this),t);function n(){return e()}}.bind(this))}_isEnabled(){const{acceptMedia:e}=this.config;return null==e||"string"==typeof e&&null!=this.runtime.guestInfo.mediaFile.type.match(new RegExp(e))}beforeInitAd(e,t,n,r,i,s){return new Promise(function(e,t){return this._isEnabled()&&(this._createSkip(s.slot),this[jo]=setInterval(()=>this._updateSkip(),250)),e()}.bind(this))}afterAdSkippableStateChange(){return new Promise(function(e,t){return this._isEnabled()&&this._updateSkip(),e()}.bind(this))}beforeAdStopped(){return new Promise(function(e,t){return null!==this[jo]&&(clearInterval(this[jo]),this[jo]=null),e()}.bind(this))}}),us.register(class extends ss{static get id(){return"vast-chain-tracking"}constructor(){super(),this._fetchStartTime=0}setConfig(e){super.setConfig(e);const{vastChainInfo:t}=e;null!=t&&this.hostInfo.addAdParamsVastChainInfo(t)}beforeLoadVast(){this._fetchStartTime=Yr()}afterLoadVast(e){let{uri:t}=e;const n=Yr()-this._fetchStartTime;this.hostInfo.addVastChainInfo("vast",t,n,!1)}afterLoadVpaid(e){let{uri:t,time:n}=e;this.hostInfo.addVastChainInfo("vpaid",t,n,!1)}});class Do extends xr{constructor(e,t){super(`HTTP ${e}`+(null!=t&&""!==t?`: ${t}`:"")),this.status=e,this.statusText=t,this.$type="HTTPError"}}class Ro{_contents=[];get length(){return this._contents.length}add(e){this._contents.push(e),this._contents.sort((e,t)=>(e.sequence||0)-(t.sequence||0))}remove(e){let t=this._contents.indexOf(e);for(;t>=0;)this._contents.splice(t,1),t=this._contents.indexOf(e,t)}get(e){return this._contents[e]}clear(){this._contents.length=0}[Symbol.iterator](){const e=this;let t=0;return{next:()=>t<e.length?{value:e.get(t++),done:!1}:{value:void 0,done:!0}}}toArray(){return this._contents.slice()}get $type(){return"SortedList"}}class $o{sequence=null}class Uo extends $o{_impressions=[];_errors=[];_verifications=[];_extensions=[];_creatives=(()=>new Ro)();id=null;conditionalAd=!1;adSystem=null;pricing=null;viewableImpression=null;get impressions(){return this._impressions}get errors(){return this._errors}get verifications(){return this._verifications}get extensions(){return this._extensions}get creatives(){return this._creatives}}class No extends Uo{_categories=[];_surveys=[];adTitle=null;description=null;advertiser=null;get categories(){return this._categories}get surveys(){return this._surveys}get $type(){return"InLine"}}class Bo extends Uo{followAdditionalWrappers=!0;allowMultipleAds=!1;fallbackOnNoAd=!1;vastAdTagURI=null;get $type(){return"Wrapper"}}class zo{_clickTrackings=[];clickThrough=null;get clickTrackings(){return this._clickTrackings}}class Wo extends zo{get $type(){return"IconClicks"}}class qo extends zo{_customClicks=[];get customClicks(){return this._customClicks}get $type(){return"VideoClicks"}}class Ho{version=null;name=null;get $type(){return"AdSystem"}}class Go{authority=null;code=null;get $type(){return"Category"}}class Qo{id=null;uri=null;get $type(){return"Click"}}class Yo extends $o{_extensions=[];id=null;adID=null;apiFramework=null;universalAdId=null;linear=null;companionAds=null;nonLinearAds=null;get extensions(){return this._extensions}get $type(){return"Creative"}}class Xo{_viewTrackings=[];program=null;width=null;height=null;xPosition=null;yPosition=null;duration=null;offset=null;apiFramework=null;pxratio=null;resource=null;resources=null;clicks=null;get viewTrackings(){return this._viewTrackings}get $type(){return"Icon"}}class Ko{id=null;uri=null;get $type(){return"Impression"}}class Zo{type=null;apiFramework=null;uri=null;get $type(){return"InteractiveCreativeFile"}}class Jo{delivery=null;type=null;width=null;height=null;codec=null;id=null;bitrate=null;minBitrate=null;maxBitrate=null;scalable=!1;maintainAspectRatio=!1;apiFramework=null;uri=null;get $type(){return"MediaFile"}}class ea{model=null;currency=null;value=null;get $type(){return"Pricing"}}class ta{type=null;uri=null;get $type(){return"Survey"}}class na{uri=null;offset=null;get $type(){return"TrackingEvent"}}class ra{_map=(()=>Object.create(null))();get types(){return Object.keys(this._map)}get(e){return this._map[e]||[]}add(e,t){this._map[e]=this._map[e]||[],this._map[e].push(t)}get $type(){return"TrackingEvents"}}class ia{idRegistry="unknown";idValue="unknown";creativeIdentifier=null;get $type(){return"UniversalAdId"}}class sa{_ads=(()=>new Ro)();adPod=null;get ads(){return this._ads}get $type(){return"AdBuffet"}}class oa extends sa{_errors=[];uri=null;version=null;get errors(){return this._errors}get $type(){return"VAST"}}class aa{_javaScriptResources=[];_flashResources=[];vendor=null;viewableImpression=null;parameters=null;get javaScriptResources(){return this._javaScriptResources}get flashResources(){return this._flashResources}get $type(){return"Verification"}}class la{_viewables=[];_notViewables=[];_viewUndetermineds=[];id=null;get viewables(){return this._viewables}get notViewables(){return this._notViewables}get viewUndetermineds(){return this._viewUndetermineds}get $type(){return"ViewableImpression"}}class ua{_clickTrackings=[];id=null;width=null;height=null;assetWidth=null;assetHeight=null;expandedWidth=null;expandedHeight=null;apiFramework=null;adSlotID=null;pxratio=null;resource=null;adParameters=null;altText=null;clickThrough=null;trackingEvents=null;get clickTrackings(){return this._clickTrackings}get $type(){return"Companion"}}class ca{_companions=[];required=null;xmlElement=null;get companions(){return this._companions}get $type(){return"CompanionAds"}}class ha{_mediaFiles=[];_interactiveCreativeFiles=[];_icons=[];skipoffset=null;duration=null;mezzanine=null;adParameters=null;videoClicks=null;trackingEvents=null;get mediaFiles(){return this._mediaFiles}get interactiveCreativeFiles(){return this._interactiveCreativeFiles}get icons(){return this._icons}get $type(){return"Linear"}}class da{_clickTrackings=[];id=null;width=null;height=null;expandedWidth=null;expandedHeight=null;scalable=!1;maintainAspectRatio=!1;minSuggestedDuration=null;apiFramework=null;resource=null;adParameters=null;clickThrough=null;get clickTrackings(){return this._clickTrackings}get $type(){return"NonLinear"}}class pa{_nonLinears=[];trackingEvents=null;get nonLinears(){return this._nonLinears}get $type(){return"NonLinearAds"}}class fa{type=null;xmlElement=null}class ma extends fa{get $type(){return"CreativeExtension"}}class ga extends fa{get $type(){return"Extension"}}class va{uri=null}class ya extends va{get $type(){return"HTMLResource"}}class ba extends va{get $type(){return"IFrameResource"}}class _a extends va{creativeType=null;get $type(){return"StaticResource"}}class wa extends va{apiFramework=null}class Aa extends wa{get $type(){return"FlashResource"}}class ka extends wa{get $type(){return"JavaScriptResource"}}class Sa{value=null}class Pa extends Sa{get $type(){return"AbsoluteTimeOffset"}}class Ea extends Sa{get $type(){return"RelativeTimeOffset"}}class xa{_ads=(()=>new Ro)();get ads(){return this._ads}get $type(){return"AdPod"}}class Ca extends xr{constructor(e,t){super(e),this.code=t,this.name="VASTParserError"}}class Ta{constructor(e){this._strictMode=e}failWithErrorCode(e,t){if(e instanceof Ca)throw e;throw new Ca(e instanceof Error?e.message:e,t)}fail(e){this.failWithErrorCode(e,101)}tryRecover(e){this._strictMode&&this.fail(e)}}var Oa=e=>"string"==typeof e&&e.length>0,Ia=e=>null!=e&&Oa(e._value),Ma=e=>Array.isArray(e)&&e.length>0;const Va=/^\s*(\d+):(\d+):(\d+(?:\.\d+)?)\s*$/;var ja=e=>{if("string"!=typeof e)return null;const t=Va.exec(e);return null==t?null:60*(60*parseInt(t[1],10)+parseInt(t[2],10))+parseFloat(t[3])},Fa=(e,t)=>{if("%"===e.charAt(e.length-1)){const t=new Ea;return t.value=parseFloat(e.substr(0,e.length-1)),t}{const n=new Pa;try{n.value=ja(e)}catch(e){t.errorHandler.tryRecover(e)}return n}},La=(e,t,n)=>{if(null!=e&&Array.isArray(e.tracking))for(const r of e.tracking){if(!Oa(r._value))continue;const e=new na;if(e.uri=r._value,Oa(r.offset))try{e.offset=Fa(r.offset)}catch(e){n.errorHandler.tryRecover(e)}t.add(r.event,e)}},Da=e=>{const t=new Qo;return t.id=e.id,t.uri=e._value,t},Ra=e=>null!=e.staticResource?(e=>{const t=new _a;return t.creativeType=e.creativeType,t.uri=e._value,t})(e.staticResource):null!=e.iFrameResource?(e=>{const t=new ba;return t.uri=e._value,t})(e.iFrameResource):null!=e.htmlResource?(e=>{const t=new ya;return t.uri=e._value,t})(e.htmlResource):null,$a=e=>{const t=new ua;return t.id=e.id,t.width=e.width,t.height=e.height,t.assetWidth=e.assetWidth,t.assetHeight=e.assetHeight,t.expandedWidth=e.expandedWidth,t.expandedHeight=e.expandedHeight,t.apiFramework=e.apiFramework,t.adSlotID=e.adSlotID,t.pxratio=e.pxratio,t.resource=Ra(e),null!=e.adParameters&&Ia(e.adParameters)&&(t.adParameters=e.adParameters._value),null!=e.altText&&Ia(e.altText._value)&&(t.altText=e.altText._value),null!=e.companionClickThrough&&Ia(e.companionClickThrough)&&(t.clickThrough=Da(e.companionClickThrough)),null!=e.companionClickTracking&&t.clickTrackings.push(...e.companionClickTracking.filter(Ia).map(Da)),null!=e.trackingEvents&&Ma(e.trackingEvents.tracking)&&(t.trackingEvents=new ra,La(e.trackingEvents,t.trackingEvents)),t},Ua=e=>{const t=new ma;return t.type=e.type,t.xmlElement=e._value,t};const Na=(e,t)=>null==e?e:t.indexOf(e)<0?parseInt(e,0):e;var Ba=e=>{const t=new Xo;return t.program=e.program,t.width=e.width,t.height=e.height,t.xPosition=Na(e.xPosition,["left","right"]),t.yPosition=Na(e.yPosition,["top","bottom"]),t.duration=e.duration,t.offset=e.offset,t.apiFramework=e.apiFramework,t.pxratio=e.pxratio,t.resources=Ra(e),null!=e.iconClicks&&(Ia(e.iconClicks.iconClickThrough)||Ma(e.iconClicks.iconClickTracking))&&(t.clicks=(e=>{const t=new Wo;return null!=e.iconClickThrough&&Ia(e.iconClickThrough)&&(t.clickThrough=Da(e.iconClickThrough)),null!=e.iconClickTracking&&t.clickTrackings.push(...e.iconClickTracking.filter(Ia).map(Da)),t})(e.iconClicks)),null!=e.iconViewTracking&&t.viewTrackings.push(...e.iconViewTracking.filter(Ia).map(Da)),t},za=e=>{const t=new Zo;return t.type=e.type,t.apiFramework=e.apiFramework,t.uri=e._value,t},Wa=e=>{const t=new Jo;return t.id=e.id,t.delivery=e.delivery,t.type=e.type,t.bitrate=e.bitrate,t.minBitrate=e.minBitrate,t.maxBitrate=e.maxBitrate,t.width=e.width,t.height=e.height,t.scalable=e.scalable,t.maintainAspectRatio=e.maintainAspectRatio,t.codec=e.codec,t.apiFramework=e.apiFramework,t.uri=e._value,t},qa=e=>{const t=new da;return t.id=e.id,t.width=e.width,t.height=e.height,t.expandedWidth=e.expandedWidth,t.expandedHeight=e.expandedHeight,t.scalable=e.scalable,t.maintainAspectRatio=e.maintainAspectRatio,t.minSuggestedDuration=e.minSuggestedDuration,t.apiFramework=e.apiFramework,t.resource=Ra(e),null!=e.adParameters&&(t.adParameters=e.adParameters._value),null!=e.nonLinearClickThrough&&Ia(e.nonLinearClickThrough)&&(t.clickThrough=Da(e.nonLinearClickThrough)),null!=e.nonLinearClickTracking&&t.clickTrackings.push(...e.nonLinearClickTracking.filter(Ia).map(Da)),t},Ha=e=>{const t=new ga;return t.type=e.type,t.xmlElement=e._value,t},Ga=e=>{const t=new Ko;return t.id=e.id,t.uri=e._value,t},Qa=e=>{const t=new Aa;return t.apiFramework=e.apiFramework,t.uri=e._value,t},Ya=e=>{const t=new ka;return t.apiFramework=e.apiFramework,t.uri=e._value,t};const Xa=e=>null!=e&&Oa(e._value);var Ka=(e,t,n,r)=>(n.id=e.id,n.conditionalAd=e.conditionalAd,n.sequence=e.sequence,null!=t.adSystem&&(n.adSystem=(e=>{const t=new Ho;return t.version=e.version,t.name=e._value,t})(t.adSystem)),null!=t.impression&&n.impressions.push(...t.impression.filter(Xa).map(Ga)),null!=t.pricing&&(n.pricing=(e=>{const t=new ea;return t.model=e.model,t.currency=e.currency,t.value=e._value,t})(t.pricing)),null!=t.error&&n.errors.push(...t.error.filter(Xa).map(e=>e._value)),null!=t.viewableImpression&&(n.viewableImpression=(e=>{const t=new la;return t.id=e.id,null!=e.viewable&&t.viewables.push(...e.viewable.map(e=>e._value)),null!=e.notViewable&&t.notViewables.push(...e.notViewable.map(e=>e._value)),null!=e.viewUndetermined&&t.viewUndetermineds.push(...e.viewUndetermined.map(e=>e._value)),t})(t.viewableImpression)),null!=t.adVerifications&&t.adVerifications.verification.forEach(e=>{try{const t=(e=>{const t=new aa;return t.vendor=e.vendor,null!=e.javaScriptResource&&t.javaScriptResources.push(...e.javaScriptResource.map(Ya)),null!=e.flashResource&&t.flashResources.push(...e.flashResource.map(Qa)),null!=e.viewableImpression&&(t.viewableImpression=e.viewableImpression._value),null!=e.verificationParameters&&(t.parameters=e.verificationParameters._value),t})(e);n.verifications.push(t)}catch(e){r.errorHandler.tryRecover(e)}}),null!=t.extensions&&n.extensions.push(...t.extensions.extension.map(Ha)),null!=t.creatives&&t.creatives.creative.forEach(e=>{try{const t=((e,t)=>{const n=new Yo;return n.id=e.id,n.sequence=e.sequence,n.adID=e.AdID||e.adID||e.adId,n.apiFramework=e.apiFramework,null!=e.universalAdId&&(n.universalAdId=(e=>{const t=new ia;return null!=e.idRegistry&&(t.idRegistry=e.idRegistry),null!=e.idValue&&(t.idValue=e.idValue),t.creativeIdentifier=e._value,t})(e.universalAdId)),null!=e.creativeExtensions&&e.creativeExtensions.creativeExtension&&n.extensions.push(...e.creativeExtensions.creativeExtension.map(Ua)),null!=e.linear?n.linear=((e,t)=>{const n=e.linear,r=new ha;var i,s;return Oa(n.skipoffset)&&(r.skipoffset=Fa(n.skipoffset,t)),null!=n.duration&&(r.duration=n.duration._value),null!=n.mediaFiles&&(null!=n.mediaFiles.mezzanine&&(r.mezzanine=n.mediaFiles.mezzanine._value),null!=n.mediaFiles.mediaFile&&r.mediaFiles.push(...n.mediaFiles.mediaFile.map(Wa)),null!=n.mediaFiles.interactiveCreativeFile&&r.interactiveCreativeFiles.push(...n.mediaFiles.interactiveCreativeFile.map(za))),null!=n.adParameters&&(r.adParameters=n.adParameters._value),null!=n.videoClicks&&(r.videoClicks=new qo,i=n.videoClicks,s=r.videoClicks,null!=i.clickThrough&&Ia(i.clickThrough)&&(s.clickThrough=Da(i.clickThrough)),null!=i.clickTracking&&s.clickTrackings.push(...i.clickTracking.filter(Ia).map(Da)),null!=i.customClick&&s.customClicks.push(...i.customClick.filter(Ia).map(Da))),null!=n.trackingEvents&&Ma(n.trackingEvents.tracking)&&(r.trackingEvents=new ra,La(n.trackingEvents,r.trackingEvents,t)),null!=n.icons&&n.icons.icon&&r.icons.push(...n.icons.icon.map(Ba)),r})(e,t):null!=e.nonLinearAds&&(n.nonLinearAds=(e=>{const t=e.nonLinearAds,n=new pa;return null!=t.nonLinear&&n.nonLinears.push(...t.nonLinear.map(qa)),null!=t.trackingEvents&&Ma(t.trackingEvents.tracking)&&(n.trackingEvents=new ra,La(t.trackingEvents,n.trackingEvents)),n})(e)),null!=e.companionAds&&(n.companionAds=(e=>{const t=e.companionAds,n=new ca;return n.required=t.required,null!=t.companion&&n.companions.push(...t.companion.map($a)),n.xmlElement=t._value,n})(e)),null==n.linear&&null==n.nonLinearAds&&null==n.companionAds&&t.errorHandler.tryRecover("Creative has no ads"),n})(e,r);n.creatives.add(t)}catch(e){r.errorHandler.tryRecover(e)}}),n),Za=e=>{const t=new Go;return t.authority=e.authority,t.code=e._value,t},Ja=e=>{const t=new ta;return t.type=e.type,t.uri=e._value,t},el=(e,t)=>{if(null!=e.inLine)return((e,t)=>{const n=new No,r=e.inLine;return Ka(e,r,n,t),n.adTitle=null!=r.adTitle?r.adTitle._value:null,null!=r.category&&n.categories.push(...r.category.filter(e=>null!=e.authority).map(Za)),n.description=null!=r.description?r.description._value:null,n.advertiser=null!=r.advertiser?r.advertiser._value:null,null!=r.survey&&n.surveys.push(...r.survey.filter(e=>e._value.length>0).map(Ja)),n})(e,t);if(null!=e.wrapper)return((e,t)=>{const n=new Bo,r=e.wrapper;return Ka(e,r,n,t),null!=r.followAdditionalWrappers&&(n.followAdditionalWrappers=r.followAdditionalWrappers),null!=r.allowMultipleAds&&(n.allowMultipleAds=r.allowMultipleAds),n.fallbackOnNoAd=r.fallbackOnNoAd,n.vastAdTagURI=null!=r.vastAdTagURI?r.vastAdTagURI._value:null,n})(e,t);throw new Error("Unrecognized ad type")},tl="b",nl="i",rl="f",il="t",sl={collections:{AdVerifications:["Verification"],Companion:["CompanionClickTracking"],CompanionAds:["Companion"],CreativeExtensions:["CreativeExtension"],Creatives:["Creative"],Extensions:["Extension"],Icon:["IconViewTracking"],IconClicks:["IconClickTracking"],Icons:["Icon"],InLine:["Category","Error","Impression","Survey"],MediaFiles:["MediaFile","InteractiveCreativeFile"],NonLinear:["NonLinearClickTracking"],NonLinearAds:["NonLinear"],TrackingEvents:["Tracking"],VAST:["Error","Ad"],Verification:["JavaScriptResource","FlashResource"],ViewableImpression:["Viewable","NotViewable","ViewUndetermined"],VideoClicks:["ClickTracking","CustomClick"],Wrapper:["Impression","Error"]},freeforms:{CreativeExtensions:["CreativeExtension"],Extensions:["Extension"]},hybrids:["CompanionAds"],types:{Ad:{sequence:nl},AdParameters:{xmlEncoded:tl},Companion:{width:nl,height:nl,expandedWidth:nl,expandedHeight:nl},Creative:{sequence:nl},Duration:{_value:il},Icon:{width:nl,height:nl,offset:il,duration:il},MediaFile:{bitrate:nl,minBitrate:nl,maxBitrate:nl,width:nl,height:nl,scalable:tl,maintainAspectRatio:tl},NonLinear:{width:nl,height:nl,assetWidth:nl,assetHeight:nl,expandedWidth:nl,expandedHeight:nl,scalable:tl,maintainAspectRatio:tl,minSuggestedDuration:il},Pricing:{_value:"f"},Wrapper:{followAdditionalWrappers:tl,allowMultipleAds:tl,fallbackOnNoAd:tl}}},ol={[tl]:e=>"true"===e||"1"===e,[nl]:e=>parseInt(e,10),[rl]:parseFloat,[il]:ja};const al=e=>t=>t.nodeType===e,ll=al(1),ul=al(3),cl=al(4),hl=(e,t)=>Array.prototype.filter.call(e.childNodes,t),dl=e=>ul(e)||cl(e),pl=(()=>{const e=/^[A-Z]+/,t=e=>1===e.length?e.toLowerCase():e.substr(0,e.length-1).toLowerCase()+e.charAt(e.length-1);return n=>n.replace(e,t)})(),fl=(e,t,n)=>null!=e[t]&&~e[t].indexOf(n);class ml{constructor(e){let{collections:t,freeforms:n,hybrids:r,types:i}=e;this._collections=t,this._freeforms=n,this._hybrids=r,this._types=i}unmarshal(e){return this._createNode(e)}_createNode(e){const t=Object.create(null);return t._value=this._isHybrid(e.nodeName)?e:this._convertPropertyValue((e=>hl(e,dl).map(e=>e.nodeValue).join("").trim())(e),e.nodeName,"_value"),this._copyAttributes(t,e),this._createCollections(t,e),this._createChildren(t,e),t}_createFreeformNode(e){const t=Object.create(null);return this._copyAttributes(t,e),t._value=e,t}_copyAttributes(e,t){const n=t.nodeName;for(let r=0;r<t.attributes.length;++r){const i=t.attributes[r],s=i.nodeName,o=i.nodeValue;e[s]=this._convertPropertyValue(o,n,s)}}_createCollections(e,t){null!=this._collections[t.nodeName]&&this._collections[t.nodeName].forEach(t=>{e[pl(t)]=[]})}_createChildren(e,t){const n=t.nodeName;hl(t,ll).forEach(t=>{const r=t.nodeName,i=pl(r);this._isFreeformParent(n)?this._isFreeformChild(n,r)&&this._addFreeformChild(t,i,e):this._addNodeChild(t,i,e,n,r)})}_addNodeChild(e,t,n,r,i){const s=this._createNode(e);if(null==n[t])n[t]=s;else{if(!this._isCollection(r,i))throw new Error(`Multiple values for ${r}.${i}`);n[t].push(s)}}_addFreeformChild(e,t,n){n[t]=n[t]||[],n[t].push(this._createFreeformNode(e))}_convertPropertyValue(e,t,n){const r=null!=this._types[t]?this._types[t][n]:null;return null!=r?ol[r](e):e}_isCollection(e,t){return fl(this._collections,e,t)}_isFreeformParent(e){return null!=this._freeforms[e]}_isFreeformChild(e,t){return fl(this._freeforms,e,t)}_isHybrid(e){return this._hybrids.indexOf(e)>=0}}const gl={strict:!1,noSingleAdPods:!1};var vl,yl={exports:{}},bl=(vl||(vl=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var l,u,c=this._events[a],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,s),!0;case 6:return c.fn.call(c.context,t,r,i,s,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var l=0,u=[],c=a.length;l<c;l++)(a[l].fn!==t||i&&!a[l].once||r&&a[l].context!==r)&&u.push(a[l]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(yl)),yl.exports),_l=c(bl);function wl(e,t){return t=t||{},new Promise(function(n,r){var i=new XMLHttpRequest,s=[],o=[],a={},l=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:l,headers:{keys:function(){return s},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var u in i.open(t.method||"get",e,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,t,n){s.push(t=t.toLowerCase()),o.push([t,n]),a[t]=a[t]?a[t]+","+n:n}),n(l())},i.onerror=r,i.withCredentials="include"==t.credentials,t.headers)i.setRequestHeader(u,t.headers[u]);i.send(t.body||null)})}const Al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",kl=e=>{let t="",n=0;do{const r=Al.indexOf(e.charAt(n++)),i=Al.indexOf(e.charAt(n++)),s=Al.indexOf(e.charAt(n++)),o=(63&r)<<2|i>>4&3,a=(15&i)<<4|s>>2&15,l=(3&s)<<6|63&Al.indexOf(e.charAt(n++));t+=String.fromCharCode(o)+(a?String.fromCharCode(a):"")+(l?String.fromCharCode(l):"")}while(n<e.length);return t};var Sl={100:"XML parsing error.",101:"VAST schema validation error.",102:"VAST version of response not supported.",200:"Trafficking error. Video player received an ad type that it was not expecting and/or cannot display.",201:"Video player expecting different linearity.",202:"Video player expecting different duration.",203:"Video player expecting different size.",300:"General Wrapper error.",301:"Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element.",302:"Wrapper limit reached, as defined by the video player. Too many Wrapper responses have been received with no InLine response.",303:"No ads VAST response after one or more Wrappers. Also includes number of empty VAST responses from fallback.",400:"General linear error. Video player is unable to display the linear ad.",401:"File not found. Unable to find Linear/MediaFile from URI.",402:"Timeout of MediaFile URI.",403:"Could not find MediaFile that is supported by this video player, based on the attributes of the MediaFile element.",405:"Problem displaying MediaFile.",406:"Mezzanine was required but not provided. Ad not served.",407:"Mezzanine is in the process of being downloaded for the first time. Download may take several hours. Ad will not be served until mezzanine is downloaded and transcoded.",408:"Conditional ad rejected.",409:"Interactive unit in the InteractiveCreativeFile node was not executed",410:"Verification unit in the Verification node was not executed.",411:"Mezzanine was provided as required, but file did not meet required specification. Ad not served.",500:"General NonLinearAds error.",501:"Unable to display NonLinear Ad because creative dimensions do not align with creative display area.",502:"Unable to fetch NonLinearAds/NonLinear resource.",503:"Could not find NonLinearresource with supported type.",600:"General CompanionAds error.",601:"Unable to display companion because creative dimensions do not fit within Companion display area.",602:"Unable to display Required Companion.",603:"Unable to fetch CompanionAds/Companion resource.",604:"Could not find Companion resource with supported type.",900:"Undefined error.",901:"General VPAID error."};class Pl extends xr{constructor(e){void 0===e&&(e=900),super(`VAST error ${e}`+(e in Sl?": "+Sl[e]:"")),this.code=e,this.$type="VASTError"}}class El extends Pl{constructor(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),super(e),this.cause=t,this.uri=n,this.$type="VASTLoaderError"}}const xl=/^data:(.*?)(;\s*base64)?,(.*)/,Cl={maxDepth:10,credentials:"omit",timeout:1e4,noSingleAdPods:!1,prepareUri:e=>e};class Tl extends _l{constructor(e,t,n){super(),this._uri=e,null!=n?(this._root=n._root,this._options=this._root._options,this._depth=n._depth+1):(this._root=this,this._options=Object.assign({},Cl,t),this._depth=1,this._fetch=this._options.fetch||Tl.fetch||wl)}load(){return this._load(this._uri).catch(e=>{throw this._emit("error",{error:e}),e})}_load(e){return Promise.resolve().then(()=>{this._emit("willFetch",{uri:e});const t=xl.exec(e);return null==t?this._fetchUri(e):this._parseDataUri(t[3],t[1],null!=t[2])}).then(t=>{let{headers:n,body:r}=t;this._emit("didFetch",{uri:e,headers:n,body:r}),this._emit("willParse",{uri:e,headers:n,body:r});const i=function(e,t){void 0===t&&(t={}),(t=Object.assign({},gl,t)).errorHandler=new Ta(t.strict);const n=((e,t)=>("string"==typeof e&&(e=(t.domParser||new DOMParser).parseFromString(e,"text/xml")),null!=e.documentElement&&(e=e.documentElement),e.getElementsByTagName("parsererror").length>0&&t.errorHandler.failWithErrorCode("XML parsing error",100),e))(e,t),r=new ml(sl);try{return((e,t)=>{const n=new oa;n.version=e.version,n.errors.push(...e.error.map(e=>e._value).filter(e=>""!==e));const[r,i]=(e=>{const t=[],n=[];for(let r=0;r<e.length;++r){const i=e[r];void 0!==i.sequence?t.push(i):n.push(i)}return[t,n]})(e.ad);if(r.length>0)if(t.noSingleAdPods&&1===e.ad.length&&1===r.length)i.push(r[0]);else{n.adPod=new xa;for(let e=0;e<r.length;e++)n.adPod.ads.add(el(r[e],t))}for(let e=0;e<i.length;e++)n.ads.add(el(i[e],t));return n})(r.unmarshal(n),t)}catch(e){t.errorHandler.fail(e)}}(r,{noSingleAdPods:this._options.noSingleAdPods});if(i.uri=e,this._emit("didParse",{uri:e,headers:n,body:r,vast:i}),0===i.ads.length)throw new El(303,null,e);const s=i.ads.get(0);return s instanceof Bo||"Wrapper"===s.$type?this._loadWrapped(s.vastAdTagURI,i):[i]})}_parseDataUri(e,t,n){return{body:n?kl(e):decodeURIComponent(e)}}_loadWrapped(e,t){return Promise.resolve().then(()=>{const{maxDepth:t}=this._options;if(t>0&&this._depth+1>=t)throw new El(302,null,e);return new Tl(e,null,this).load()}).then(e=>[t,...e])}_fetchUri(e){const t=this._options.prepareUri(e),n=this._fetchWithCredentials(t),r=this._createTimeouter(n,t);return Promise.race([n,r]).then(e=>(r.cancel(),e)).catch(e=>{if(r.cancel(),this._depth>1)throw new El(301,null,t);throw e})}_fetchWithCredentials(e){let{credentials:t}=this._options;return"function"==typeof t&&(t=t(e)),Array.isArray(t)||(t=[t]),t.reduce((t,n)=>t.catch(()=>this._tryFetch(e,n)),Promise.reject(new Error))}_tryFetch(e,t){return this._root._fetch(e,{credentials:t}).then(t=>{if(!t.ok){const n=new Do(t.status,t.statusText);throw new El(301,n,e)}return t.text().then(e=>({headers:t.headers,body:e}))}).catch(n=>{throw this._emit("fetchError",{uri:e,credentials:t,error:n}),n})}_createTimeouter(e,t){const n=this._options.timeout;let r=null;const i=new Promise((e,i)=>{r=setTimeout(()=>{i(new El(301,null,t))},n)});return i.cancel=()=>{null!=r&&(clearTimeout(r),r=null)},i}_emit(){this._root.emit(...arguments)}}Tl.fetch=void 0;const Ol={visibility:"hidden",position:"absolute",left:0,top:0,width:0,height:0,margin:0,padding:0,border:0},Il=/^https?:\/\//,Ml=e=>{let t=null;try{t=e.document.baseURI}catch(e){}return null!=t&&Il.test(t)?t:null},Vl=(e,t,n)=>new Promise(function(r,i){let s,o;return s=Yr(),Promise.resolve(Gr(e,t,n)).then(function(e){try{return o=Yr()-s,r(o)}catch(e){return i(e)}},i)}),jl=(e,t)=>new Promise(function(n,r){let i,s,o,a,l;return i=t.ownerDocument,s=i.defaultView,o=s.getVPAIDAd,delete s.getVPAIDAd,Promise.resolve(Vl(e,null,i)).then(function(e){try{a=e;try{l=s.getVPAIDAd()}finally{s.getVPAIDAd=o}return n({vpaid:l,time:a})}catch(e){return r(e)}},r)}),Fl=(e,t)=>new Promise(function(n,r){let i,s,o,a,l,u;return Promise.resolve(((e,t)=>new Promise(function(n,r){return Promise.resolve(_r(e.ownerDocument)).then(function(i){try{return n(((e,t)=>new Promise(function(n,r){let i,s;return i=e.ownerDocument.createElement("iframe"),s=br(i,"load"),i.loading="eager",i.frameBorder="0",i.scrolling="no",hr(i,t,!0),i.srcdoc='<div style="display:none !important; width: 0 !important; height: 0 !important;"></div>',e.appendChild(i),Promise.resolve(Promise.race([s,wr(i)])).then(function(e){try{return n(i)}catch(e){return r(e)}},r)}))(e,t))}catch(e){return r(e)}},r)}))(t,Ol)).then(function(t){try{return i=t,s=i.contentWindow,o=s.document,a=(e=>((e,t)=>{let n=0,r=t(e);for(;null==r&&e!==e.parent&&n<10;)r=t(e=e.parent),++n;return r})(e,Ml))(s),o.write("<html><head>"+(null!=a?`<base href="${(e=>{const t=document.createElement("span");return t.textContent=e,t.innerHTML})(a)}">`:"")+"</head><body></body></html>"),o.close(),Promise.resolve(Vl(e,null,o)).then(function(e){try{return l=e,u=s.getVPAIDAd(),n({iframe:i,vpaid:u,time:l})}catch(e){return r(e)}},r)}catch(e){return r(e)}},r)}),Ll={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},Dl=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],Rl=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],$l=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"],Ul="undefined"!=typeof window&&void 0!==window.document?window.document:{},Nl="fullscreenEnabled"in Ul&&Object.keys(Ll)||Dl[0]in Ul&&Dl||Rl[0]in Ul&&Rl||$l[0]in Ul&&$l||[],Bl={get changeEventType(){return Nl[Ll.fullscreenchange]},isActive(e){const{ownerDocument:t}=e,n=Nl[Ll.fullscreenElement];return null!=t&&t[n]===e},request(e){if(Bl.isActive(e))return Promise.resolve();const t=Nl[Ll.requestFullscreen];return"function"!=typeof e[t]?Promise.reject(new Error("Not supported")):si(e[t](),3e3)},exit(e){const t=Nl[Ll.exitFullscreen];return"function"!=typeof e[t]?Promise.reject(new Error("Not supported")):si(e[t](),1e3)}},zl=Symbol("url"),Wl=Symbol("options"),ql=Symbol("pubSub"),Hl=Symbol("skippable"),Gl=Symbol("slot"),Ql=Symbol("videoSlot"),Yl=Symbol("clickSlot"),Xl=Symbol("width"),Kl=Symbol("height"),Zl=Symbol("viewMode"),Jl=Symbol("volumeImpaired"),eu=Symbol("volume"),tu=Symbol("paused"),nu=Symbol("stopped"),ru=Symbol("loaded"),iu=Symbol("clicked"),su=Symbol("requested"),ou=Symbol("domEventTracker"),au=Symbol("tickInterval"),lu=Symbol("quartile"),uu=Symbol("monitors"),cu=Symbol("lastTimeChangeTimestamp"),{internal:hu}=ns,du={noMutedAutoplayFallback:!1,noPauseOnClickThrough:!1,skipOffset:null},pu={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},fu={position:"absolute",left:"0",top:"0",border:"0",margin:"0",padding:"0"},mu=Object.assign({},fu,{cursor:"pointer"}),gu="duration",vu="remainingTime",yu="volume",bu="skippableState",_u="size",wu={[gu]:[["getAdDuration"],"AdDurationChange"],[vu]:[["getAdRemainingTime"],"AdRemainingTimeChange"],[yu]:[["getAdVolume"],"AdVolumeChange"],[bu]:[["getAdSkippableState"],"AdSkippableStateChange"],[_u]:[["getAdWidth","getAdHeight"],"AdSizeChange"]};class Au{constructor(e,t){this[zl]=e,this[Wl]=Object.assign({},du,t),this[ql]=new ps,this[Hl]=null==this[Wl].skipOffset,this[Xl]=ye,this[Kl]=ye,this[Zl]=null,this[Jl]=!1,this[eu]=ye,this[Gl]=null,this[Ql]=null,this[tu]=!0,this[nu]=!1,this[ru]=!1,this[iu]=!1,this[hu]=!0,this[ou]=new Pr,this[su]={},this[au]=null,this[lu]=-1,this[uu]=this._buildMonitors(),this[cu]=Yr(),this._handleTimeChange=this._handleTimeChange.bind(this),this._onTick=this._onTick.bind(this);for(let e=0;e<Ae.length;++e){const t=Ae[e];this[t]=Qr(this[t]).bind(this)}Re({rel:"preconnect",href:e,pr:"1.0"})}_getSlot(){return this[Gl]}getAdLinear(){return!0}getAdWidth(){return this._isFullscreen()?screen.width:this[Xl]}getAdHeight(){return this._isFullscreen()?screen.height:this[Kl]}getAdExpanded(){return!1}getAdSkippableState(){return this[Hl]}getAdRemainingTime(){if(this[ru]&&null!=this[Ql]){const{currentTime:e,duration:t}=this[Ql];if(isFinite(e)&&isFinite(t)&&t>0&&e>=0)return t-e}return ye}getAdDuration(){if(this[ru]&&null!=this[Ql]){const{duration:e}=this[Ql];if(isFinite(e)&&e>0)return e}return ye}getAdVolume(){if(this[ru]&&null!=this[Ql]){const{volume:e,muted:t}=this[Ql];if("boolean"==typeof t&&t)return 0;if(isFinite(e))return e}return this[eu]}setAdVolume(e){this[eu]=e,null!=this[Ql]&&(this._setVolume(e),this[Jl]&&this._notifyMonitor(yu))}getAdCompanions(){return""}getAdIcons(){return!1}handshakeVersion(){return"2.0"}initAd(e,t,n,r,i,s){let{videoSlot:o,slot:a,sendErrorInfo:l}=s||{};const u=null==a||null==a.ownerDocument;this[ql].options.sendErrorInfo=!0===l,u&&(a=document.createElement("div"),hr(a,fu)),null==o&&(o=a.ownerDocument.createElement("video"),hr(o,fu),a.appendChild(o)),this[Gl]=a,this[Ql]=o,this[Yl]=a.ownerDocument.createElement("div"),hr(this[Yl],mu,!0),a.appendChild(this[Yl]),this[Jl]=!("volume"in o&&"muted"in o),this._setDimensions(e,t,n,!1),this._preloadSrc(this[zl]);const c=()=>{this._publish(be.AdLoaded)};u?_r(document).then(()=>{document.body.appendChild(a),c()}):c()}resizeAd(e,t,n){this._setDimensions(e,t,n,!0)}startAd(){this._request(be.AdImpression),this._addDomListeners(),this[Ql].pause(),this[eu]>=0&&(this._setVolume(this[eu]),this._notifyMonitor(yu)),this._initVideoSlot(this[zl]),this[ru]=!0,this._publish(be.AdStarted),this[tu]=!1,this._play()}stopAd(){this._stop()}skipAd(){this._request(be.AdSkipped),this._stop()}pauseAd(){this._pause()}resumeAd(){this._resume()}expandAd(){}collapseAd(){}subscribe(e,t,n){void 0===n&&(n=null),this[ql].subscribe(e,t,n)}unsubscribe(e,t){this[ql].unsubscribe(e,t)}_publish(e,t){void 0===t&&(t=[]),this[ql].publish(e,t)}_addDomListeners(){var e,t;this[ou].removeAll(),this[ou].add(this[Yl],"click",this._onClickSlotClick,this).add((e=this[Ql].ownerDocument,null!=(t=e)&&"function"==typeof t.addEventListener?e:document),Bl.changeEventType,this._onFullscreenchange,this).addMany(this[Ql],{durationchange:this._onVideoDurationchange,volumechange:this._onVideoVolumechange,playing:this._onVideoPlaying,play:this._onVideoPlay,pause:this._onVideoPause,seeked:this._onVideoSeeked,ended:this._onVideoEnded,error:this._onVideoError,timeupdate:this._onVideoTimeupdate},this)}_onClickSlotClick(){if(this[nu])this._publish(be.AdClickThru,[null,null,!0]);else if(this[iu]&&this[tu])this[tu]&&(this[iu]=!1,this._resume());else{const{noPauseOnClickThrough:e}=this[Wl];e||this[tu]||this._pause(),this[iu]=!0,this._publish(be.AdClickThru,[null,null,!0])}}_onTick(){Yr()-this[cu]>=245&&this._handleTimeChange()}_onVideoDurationchange(){this._notifyMonitor(gu),this._notifyMonitor(vu)}_onVideoVolumechange(){this._notifyMonitor(yu)}_onVideoPlaying(){this._satisfy(be.AdImpression),this._satisfy(be.AdPlaying),this._startTicking()}_onVideoPlay(){}_onVideoPause(){this._stopTicking(),this._satisfy(be.AdPaused),this._satisfyStopRequest()}_onVideoSeeked(){this._notifyMonitor(vu)}_onVideoEnded(){this._handleTimeChange(),this._stop()}_onVideoError(){const{error:e}=this[Ql],t="Video Playback Error"+(e=>{if(null==e||null==e.code&&ze(e.message))return" (no error code, no error message)";const{code:t,message:n}=e;if(null==t)return`: ${n} (no error code)`;const r=pu[t];return null==r?ze(n)?` (unknown error code ${t}, no error message)`:`: ${n} (unknown error code ${t})`:`: ${r} ${ze(n)?"(no error message)":`- ${n}`}`})(e),n=new Or(t,405,null,this[zl]),r={message:n.toString(),code:n.code,subject:n.subject};this._publish(be.AdError,[r.message,r]),this._stop()}_onVideoTimeupdate(){this._onTick()}_preloadSrc(e){const{src:t,currentSrc:n}=this[Ql];null!=t&&""!==t||null!=n&&""!==n||(this[ou].add(this[Ql],"error",this._onVideoError,this),this._initVideoSlot(e))}_initVideoSlot(e){"function"==typeof this[Ql].setAttribute?(this[Ql].setAttribute("playsinline","true"),this[Ql].setAttribute("webkit-playsinline","true")):this[Ql].playsInline=!0,this[Ql].autoplay=!1,this[Ql].controls=!1,this[Ql].loop=!1,this[Ql].src=e}_setDimensions(e,t,n,r){"fullscreen"===n?this._requestFullscreen().catch(e=>{this._publishAdLog(`Fullscreen mode failed: ${e}`)}):this._exitFullscreen().catch(vr).then(()=>{this._setDimensionsNormal(e,t),r&&this._notifyMonitor(_u)})}_setDimensionsNormal(e,t){this[Xl]=e,this[Kl]=t,this[Zl]="normal";const n={width:e+"px",height:t+"px"};hr(this[Ql],n),hr(this[Gl],n),hr(this[Yl],n,!0)}_requestFullscreen(){return this._isFullscreen()?Promise.resolve():Bl.request(this[Ql]).then(()=>{},e=>{throw e})}_exitFullscreen(){return this._isFullscreen()?Bl.exit(this[Ql].ownerDocument).catch(e=>{throw e}):Promise.resolve()}_onFullscreenchange(){const e=this._isFullscreen()?"fullscreen":"normal";e!==this[Zl]&&(this[Zl]=e,this._notifyMonitor(_u))}_isFullscreen(){return null!=this[Ql]&&Bl.isActive(this[Ql])}_setVolume(e){this[Ql].volume!==e&&(this[Ql].volume=e);const t=0===e;this[Ql].muted!==t&&(this[Ql].muted=t)}_play(){const{noMutedAutoplayFallback:e}=this[Wl],t=this[Ql].muted,n=this[Ql].play();null!=n&&"function"==typeof n.catch?(this._publish(be.AdMutedUnmutedPlayback,t?[{mutedPlaybackAttempted:!0}]:[{unmutedPlaybackAttempted:!0}]),n.then(()=>{this._publish(be.AdMutedUnmutedPlayback,[{playbackSuccessful:!0}])}).catch(n=>{if(t)throw n;if(this._publishAdLog(`Unmuted playback failed: ${n}`),this[tu])this._publishAdLog("Unmuted playback failed and ad is paused, not falling back to muted playback"),this._publish(be.AdMutedUnmutedPlayback,[{playbackSuccessful:!1,adPaused:!0}]);else{if(!e)return this._publishAdLog("Unmuted playback failed, attempting fallback to muted playback"),this[Ql].muted=!0,this._publish(be.AdMutedUnmutedPlayback,[{mutedPlaybackAttempted:!0}]),this[Ql].play();this._publishAdLog("Unmuted playback failed and fallback to muted playback disabled, giving up"),this._publish(be.AdMutedUnmutedPlayback,[{playbackSuccessful:!1,mutedPlaybackDisabled:!0}])}}).catch(e=>{this._publish(be.AdMutedUnmutedPlayback,[{playbackSuccessful:!1}]),this._publishAdLog(`Muted playback failed: ${e}`)})):this._publishAdLog("Video slot does not report disallowed play attempts")}_pause(){this[tu]=!0,null==this[Ql]||this[Ql].paused?this._publish(be.AdPaused):(this._request(be.AdPaused),this[Ql].pause())}_resume(){this[tu]=!1,null!=this[Ql]&&this[Ql].paused?(this._request(be.AdPlaying),this._play()):this._publish(be.AdPlaying)}_stop(){this._stopTicking(),this[tu]=!0,this[nu]=!0,this._request(be.AdStopped),null==this[Ql]||this[Ql].paused||this[Ql].ended?this._satisfyStopRequest():this[Ql].pause()}_satisfyStopRequest(){this._requested(be.AdStopped)&&(this[Wl].autoDisposeDisabled||this[ou].removeAll(),null!=this[Ql]&&this._resetMediaSrc(),this._satisfy(be.AdSkipped),this._satisfy(be.AdStopped))}_resetMediaSrc(){const e=this[Ql];"function"==typeof e.removeAttribute?(e.removeAttribute("src"),e.load()):e.src="",this[ru]=!1}_startTicking(){null==this[au]&&(this[au]=setInterval(this._onTick,250),this._handleTimeChange())}_stopTicking(){null!=this[au]&&(this._handleTimeChange(),clearInterval(this[au]),this[au]=null)}_handleTimeChange(){if(this[cu]=Yr(),!this[ru])return;const e=this[Ql];null==e||e.readyState<1||null!=e.error||(this._notifyMonitor(gu),this._notifyMonitor(vu),this._handleSkippableState(),this._handleQuartiles())}_handleSkippableState(){const{skipOffset:e}=this[Wl],{currentTime:t}=this[Ql];!this[Hl]&&"number"==typeof e&&t>=e&&(this[Hl]=!0,this._notifyMonitor(bu))}_handleQuartiles(){const{currentTime:e,duration:t,ended:n,played:r}=this[Ql],i=null!=r&&r.length>0?(s=r,Array.apply(null,s).reduce((e,t,n)=>e+s.end(n)-s.start(n),0)):e;var s;if(!isFinite(i)||i<0||!isFinite(t)||t<=0)return;const o=this[lu],a=n?.25:0;this[lu]=Math.min(Math.max(o,Math.floor((i+a)/t*4)),4);for(let e=o+1;e<=this[lu];++e)this._publish(Se[e])}_request(e){this[su][e]=!0}_requested(e){return!!this[su][e]}_satisfy(e){this._requested(e)&&(this[su][e]=!1,this._publish(e))}_buildMonitors(){const e={},t=Object.keys(wu);for(let n=0;n<t.length;++n){const r=t[n],[i,s]=wu[r];e[r]=this._buildMonitor(i,s)}return e}_buildMonitor(e,t){const n=()=>e.map(e=>this[e]()).join("\0");let r=n();return()=>{const e=n();e!==r&&(r=e,this._publish(t))}}_notifyMonitor(e){this[uu][e]()}_publishAdLog(e){this._publish(be.AdLog,[e])}}const{runtime:ku,clickThroughUrl:Su,options:Pu}=ns,Eu=[/\/adbridge-vpaid\.min\.js(?:\?|#|$)/,/\/\/(?:www\.)?wootag\.com\/player\/(?:ad\/)?v3\/bundle\.js(?:\?|#|$)/,/\/\/(?:www\.)?viewbix\.com\/plugins\/vpaid\.bundle\.js(?:\?|#|$)/,/\/\/(?:[^/]+\.)?(?:ssl-images|media)-amazon\.com\//],{phaser:xu,runtime:Cu}=ns,Tu=["GuestNotAvailableError","MethodNotAvailableError"],Ou=["initAd","startAd","stopAd","skipAd"],{runtime:Iu}=ns,Mu=(e,t,n)=>{null==e[t]&&(e[t]=function(){let e=null;try{for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];e=this._phasedGuestCallSync(t,i)}catch(t){if(!(null!=t&&Tu.indexOf(t.name)>=0))throw t;e=n}return e})},Vu=(e,t)=>{null==e[t]&&(e[t]=function(){Ou.indexOf(t)>=0&&this[Iu].track(t);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._phasedGuestCall(t,n).catch(e=>{this._onError(e,t)})})};var ju,Fu,Lu;!function(e){e.DISPLAY="display",e.VIDEO="video"}(ju||(ju={})),Object.values(ju),function(e){e.UE="ue",e.UW="uw",e.EU="eu",e.AS="as"}(Fu||(Fu={})),Object.values(Fu),function(e){e.SKYFAKE="skyfake",e.AMAZON="amazon",e.TWITCH="twitch"}(Lu||(Lu={}));const Du="https",Ru="";class $u{config;constructor(e){this.config={urlComponents:e,queryParams:new Map,delimiter:"?"}}build(){return`${this.baseUrl}${this.buildQueryString()}`}addQueryParameter(e){return this.isValidParameter(e)&&this.config.queryParams.set(e.key,e),this}addQueryParameters(e){for(const t of e)this.addQueryParameter(t);return this}addRawQueryParameters(e,t){for(const[n,r]of Object.entries(e))this.addQueryParameter({key:n,value:r,...t});return this}setQueryParameters(e){return this.config.queryParams=this.generateQueryParametersMapFromList(e??[]),this}setDelimiter(e){return this.config.delimiter=e,this}get baseUrl(){return(e=>{let{protocol:t=Du,hostname:n,path:r=Ru}=e;return`${t}://${n}${r}`})(this.config.urlComponents)}get queryParametersString(){return this.buildQueryParams(this.getQueryParameterList())}get parameters(){const e={};for(const[t,n]of this.config.queryParams.entries())e[t]=n.value;return e}getQueryParameterList(){return Array.from(this.config.queryParams.values())}mapQueryParameter(e){return e}buildQueryString(){return""===this.queryParametersString?"":`${this.config.delimiter}${this.queryParametersString}`}buildQueryParams(e){return null==e||0===e.length?"":e.map((t=this.mapQueryParameter.bind(this),n=this.buildParameter.bind(this),e=>n(t(e)))).join("&");var t,n}buildParameter(e){const t=e.value?.toString()??"";return`${encodeURIComponent(e.key)}=${e.encode??1?encodeURIComponent(t):t}`}isValidParameter(e){let{value:t}=e;return null!=t&&""!==t}generateQueryParametersMapFromList(e){return new Map(((e,t,n)=>{const r=[];for(const i of e)t(i)&&r.push(n(i));return r})(e,this.isValidParameter.bind(this),e=>[e.key,e]))}}class Uu extends $u{priorityMapping={};defaultPriority=0;setPriorityMapping(e){return this.priorityMapping=Object.assign({},e),this}extendPriorityMapping(e){return Object.assign(this.priorityMapping,e),this}setPriorityMappingSequence(e,t){return this.priorityMapping={},this.extendPriorityMappingSequence(e,t)}extendPriorityMappingSequence(e,t){return void 0===t&&(t=this.defaultPriority),e.forEach((e,n)=>{this.priorityMapping[e]=n+t}),this}setDefaultPriority(e){return this.defaultPriority=e,this}getQueryParameterList(){return super.getQueryParameterList().sort(this.compareQueryParameters.bind(this))}compareQueryParameters(e,t){return this.processQueryPriority(e)-this.processQueryPriority(t)}processQueryPriority(e){return this.priorityMapping[e.key]??e.priority??this.defaultPriority}}var Nu,Bu,zu,Wu,qu;Lu.SKYFAKE,Lu.AMAZON,Lu.TWITCH,function(e){e.DV="DV",e.DV_TECH="DV_TECH"}(Nu||(Nu={})),Nu.DV,Nu.DV_TECH,function(e){e.EVENT="EVENT",e.VISIT="VISIT"}(Bu||(Bu={})),Object.values(Bu),function(e){e.DVP_PREFIX="dvp_",e.DVPF_PREFIX="dvpf_"}(zu||(zu={})),Bu.EVENT,Bu.VISIT,Bu.EVENT,Bu.VISIT,Lu.SKYFAKE,Lu.AMAZON,Lu.TWITCH,Bu.EVENT,Bu.VISIT,function(e){e.PROTOCOL_VERSION="v",e.HIT_TYPE="t",e.TRACKING_ID="tid",e.CTX="ctx",e.CMP="cmp",e.CACHE_BUSTER="z",e.EVENT_ACTION="ea",e.EVENT_LABEL="el",e.EVENT_CATEGORY="ec",e.EVENT_VALUE="ev",e.REDIRECT_URL="redir",e.CLIENT_ID="cid",e.DOCUMENT_REFERRER="dr",e.GDPR_APPLIES="gdpr",e.GDPR_CONSENT="gdpr_consent"}(Wu||(Wu={})),function(e){e.CUSTOM_DIMENSION_PREFIX="cd",e.CUSTOM_METRIC_PREFIX="cm"}(qu||(qu={}));const Hu={redir:1/0},Gu={protocol:"https",hostname:"vfw.amazon-adsystem.com",path:"/dv/vtrk.doubleverify.com"},Qu={[Lu.SKYFAKE]:{protocol:"https",hostname:"video-qa.doubleverify.com",path:"/skyfake/pxsrv"},[Lu.AMAZON]:Gu,[Lu.TWITCH]:Gu},Yu={protocol:"https",hostname:"vtrk.dv.tech"},Xu=new Set(Object.values(Wu)),Ku=new RegExp(`^(?:${qu.CUSTOM_DIMENSION_PREFIX}|${qu.CUSTOM_METRIC_PREFIX})(?:[1-9]\\d?|1\\d{2}|200)$`),Zu=[Wu.EVENT_ACTION,Wu.EVENT_CATEGORY];var Ju;!function(e){e.DISABLED="DISABLED",e.DATE="DATE",e.MACRO="MACRO",e.CUSTOM="CUSTOM"}(Ju||(Ju={}));class ec extends Uu{constructor(e){const t=ec.generateURIBase(e??{});var n;t.path="/"===(n=t.path??"").slice(-1)?n:`${n}/`,super(t),this.setPriorityMapping(Hu)}setCustomDimension(e,t){return this.addQueryParameter({key:`${qu.CUSTOM_DIMENSION_PREFIX}${e}`,...t})}setCustomMetric(e,t){return this.addQueryParameter({key:`${qu.CUSTOM_METRIC_PREFIX}${e}`,...t})}build(){return function(e){const t=[];for(const n of Zu)e.has(n)||t.push(`"${n}" is required`);for(const{key:n}of e.values())Xu.has(n)||Ku.test(n)||t.push(`"${n}" is not a valid Pxsrv field`);if(t.length>0)throw new Error(`Validation failed: ${t.join("; ")}`)}(this.config.queryParams),super.build()}setCacheBusterMode(e,t){const n=function(e,t){switch(e){case Ju.DISABLED:return null;case Ju.CUSTOM:return{value:(t??"").toString(),encode:!0};case Ju.MACRO:return{value:"[CACHEBUSTING]",encode:!1};case Ju.DATE:{const e=1e6+Math.floor(9e6*Math.random());return{value:`${(new Date).getTime()}${e}`,encode:!1}}}}(e,t);return null!=n&&this.addQueryParameter({key:Wu.CACHE_BUSTER,value:n.value,encode:n.encode}),this}static generateURIBase(e){let{hostname:t,proxy:n}=e;if(null!=n&&null!=Qu[n.value])return Qu[n.value];const r=Object.assign({},Yu);return null!=t&&""!==t&&(r.hostname=t),r}}const tc=e=>(e=>"string"==typeof e&&e.startsWith("data:"))(e)?"data:":e,nc={timeout:2e3,postAllowed:!1,styles:{position:"absolute",top:0,left:0,width:0,height:0,border:0,pointerEvents:"none",visibility:"hidden"}},rc=()=>{};class ic{_url;_options;_window;_deferred=null;_image=null;constructor(e,t){void 0===t&&(t={}),this._url=e,this._options=Object.assign({},nc,t);let n=window,r=0;try{for(;r<10&&n.parent!==n&&null!=n.parent.document.createElement("img");)n=n.parent,++r}catch(e){}this._window=n}get promise(){return null!=this._deferred?this._deferred.promise:null}load(){return null!=this._deferred?Promise.reject(new Error("Already loading")):(this._deferred=yr(),this._deferred.promise.catch(rc),(this._options.postAllowed&&"function"==typeof navigator.sendBeacon?this._sendBeacon:this._loadPixel).call(this),this._deferred.promise)}dispose(){this._rejectWith("Disposed")}_sendBeacon(){const e=navigator.sendBeacon(this._url,"");null!=this._deferred&&(e?this._deferred.resolve():this._deferred.reject(new Error("Failed")))}_loadPixel(){this._image=this._window.document.createElement("img"),this._image.src=this._url,Object.assign(this._image.style,this._options.styles),this._image.onload=this._onImageLoad.bind(this),this._image.onerror=this._onImageError.bind(this),this._window.document.body.appendChild(this._image),setTimeout(this._onImageTimeout.bind(this),this._options.timeout)}_onImageLoad(){null!=this._deferred&&this._deferred.resolve(),this._remove()}_onImageError(){this._rejectWith("Unknown error")}_onImageTimeout(){this._rejectWith("Timed out")}_rejectWith(e){null!=this._deferred&&this._deferred.reject(new Error(e)),this._remove()}_remove(){null!=this._image&&(null!=this._image.parentNode&&this._image.parentNode.removeChild(this._image),this._image=null)}}function sc(){if("object"==typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=(new Date).getTime(),t="undefined"!=typeof performance&&"function"==typeof performance.now?1e3*performance.now():0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===n?r:3&r|8).toString(16)})}const oc=Symbol("timings"),ac=Symbol("eventCount"),lc=Symbol("lastEventTime"),uc=Symbol("handlers"),cc=Symbol("configured"),hc=Symbol("configuring"),dc=Symbol("gpdrApplies"),pc=Symbol("gdprConsent"),fc=Symbol("doNotSampleAdLoadedEvents"),mc=Symbol("currentTimestampInCacheBuster"),gc=Symbol("config"),{runtime:vc,internal:yc}=ns,bc=Yr(),_c=["start","load","initAd","AdLoaded","startAd","AdStarted"],wc=Math.random()<.1,Ac=document,kc=(()=>{let e=window,t=0;try{for(;t<10&&e.parent!==e&&null!=e.parent.location&&null!=e.parent.location.hostname;)e=e.parent,++t}catch(e){}return e})().location.hostname,Sc=[];class Pc{constructor(e){this[yc]=!0,this[oc]={start:bc},this[ac]=0,this[lc]=bc,this[uc]=[],this[cc]=!1,this[hc]=yr(),this[dc]=null,this[pc]=null,this[fc]=!1,this[gc]={};const t=`vpaid-transformer@${u}+js`,n=t=>{const{mediaFile:n}=e[vc].guestInfo;return null==n||Qe(n)?void 0:n[t]};this.addEventLabel(()=>tc(e[vc].hostInfo.originVastUrl)),this.addDimension(136,()=>{const{uriBlacklistedForFriendlyIframe:t}=e[vc].contextInfo;return null==t?null:t<<1|e[vc].isFlagEnabled(4)}),this.addDimension(137,()=>{const{imaSdkPresent:t,hasImaVpaidMediaFiles:n,hasNonImaVpaidMediaFiles:r}=e[vc].contextInfo;return null==t||null==n||null==r?null:(t?"Y":"N")+(n?"Y":"N")+(e[vc].isFlagEnabled(2)?"Y":"N")+(r?"Y":"N")}),this.addDimension(140,()=>e[vc].videoPlaybackContext.toString()),this.addDimension(138,()=>{const{slotProvidedOnInitAd:t}=e[vc].contextInfo;return null==t?null:t?"1":"0"}),this.addDimension(139,()=>{const{videoSlotProvidedOnInitAd:t}=e[vc].contextInfo;return null==t?null:t?"1":"0"}),this.addDimension(100,()=>e[vc].hostInfo.viewMode),this.addDimension(104,()=>n("type")),this.addDimension(103,()=>tc(n("uri"))),this.addDimension(105,()=>t),this.addDimension(107,()=>Ac.readyState),this.addDimension(171,()=>kc),this.addDimension(109,()=>tc(e[vc].hostInfo.innermostVastUrl)),this.addDimension(116,()=>0===e[vc].hostInfo.vastChainInfo.length?null:e[vc].hostInfo.vastChainInfo.map(e=>e.join(":")).join(",")),this.addMetric(100,()=>e.getAdWidth()),this.addMetric(101,()=>e.getAdHeight()),this.addMetric(104,()=>e.getAdVolume()),this.addMetric(105,()=>n("width")),this.addMetric(106,()=>n("height")),this.addMetric(107,()=>n("bitrate")),this.addMetric(108,()=>e[vc].hostInfo.desiredBitrate),this.addMetric(109,()=>{const e=(()=>{const e=window.navigator&&window.navigator.connection&&window.navigator.connection.downlink;return null!=e?1024*e:1/0})();return isFinite(e)?e:-1}),this.addMetric(110,()=>Yr()-bc),this.addMetric(111,()=>{const e=Yr(),t=e-this[lc];return this[lc]=e,t}),this.addMetric(112,()=>e[vc].hostInfo.width),this.addMetric(113,()=>e[vc].hostInfo.height),this.addMetric(167,()=>e.getAdDuration());for(let e=0;e<_c.length-1;e++){const t=180+e,n=_c[e],r=_c[e+1];this.addMetric(t,()=>this._getTimingInfo(n,r))}window.addEventListener("unload",()=>this.track("global-unload")),window.addEventListener("error",e=>this.trackError("global-error",(e=>{if(null!=e){const{error:t}=e;if(null!=t)return t;{const{message:t,filename:n,lineno:r,colno:i}=e;return{message:t,filename:n,lineno:r,colno:i}}}return"[Unknown error]"})(e)));const r=t=>e.subscribe(()=>this.track(t),t);r(be.AdStarted),r(be.AdImpression),r(be.AdStopped),e.subscribe(this._handleAdLoadedEvent,be.AdLoaded,this),e.subscribe(this._handleAdErrorEvent,be.AdError,this);let i=null;try{const{src:e}=jr(),t=Br(e);i=pi(t)}catch(e){}this.track("load",null,i)}_handleAdErrorEvent(e,t){const n=null==t?null:t.code,r=null==n?null:{[fs]:n};this.trackError(be.AdError,e,r,null,!0)}_handleAdLoadedEvent(){this.track(be.AdLoaded,null,null,this[fc]||l)}get configured(){return this[cc]}get gdprApplies(){return this[dc]}get gdprConsent(){return this[pc]}set gdprApplies(e){this[dc]=e}set gdprConsent(e){this[pc]=e}configure(e){let{wrapperId:t,customDimensions:n,customMetrics:r,trackingUri:i,trackingHost:s,adServingId:o,dvConsolidationId:a,ctx:l,cmp:u,gdpr:c,gdpr_consent:h,alwaysTrackVastChains:d=!1,currentTimestampInCacheBuster:p=!1}=e;this[cc]||null==t&&null==l||(this[gc]={ctx:l,cmp:u,wrapperId:t,baseUrl:i??"https://vtrk.dv.tech",clientId:a??o??sc(),trackingId:null==l?`ZW-${t}`:void 0},this._logIds(this[gc]),null!=n&&Object.keys(n).forEach(e=>{e!==116..toString()&&this.addDimension(e,()=>n[e])}),null!=r&&Object.keys(r).forEach(e=>{this.addMetric(e,()=>r[e])}),null!=c&&(this.gdprApplies=c),null!=h&&(this.gdprConsent=h),this[fc]=d,this[mc]=p,this[cc]=!0,this[hc].resolve())}_logIds(e){null!=e.cmp&&e.cmp,e.ctx}track(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=l);try{if(this._addTiming(e),!r&&(!wc||this[ac]>=100))return;this[ac]++;const i=e+(r?"":"/10"),s=this._getPixelInfo(t,n);this._pxsrvTrack("vpaid",i,s)}catch(e){}}trackError(e,t,n,r,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!1);const s=ji(t=t||"[Unknown error]"),o=Object.assign({},n,{[ms]:s.substring(0,1e3)});this.track(e,o,r,i)}addEventLabel(e){this[uc].push(t=>{t.label=e()})}addDimension(e,t){this._addField("customDimensions",e,t)}addMetric(e,t){this._addField("customMetrics",e,t)}_addField(e,t,n){this[uc].push(r=>{r[e][`${t}`]=n()})}_addTiming(e){null==this[oc][e]&&(this[oc][e]=Yr())}_pxsrvTrack(e,t,n){this[cc]?this._trackEvent(e,t,n):this[hc].promise.then(()=>{n=this._mergeOptions(this._getPixelInfo(null,null),n),this._trackEvent(e,t,n)})}_trackEvent(e,t,n){const r=this._buildPxsrvUrl(e,t,n),i=new ic(r,{postAllowed:!0}),s=i.load().catch(()=>{});return Sc.push(s),i}_buildPxsrvUrl(e,t,n){const r=new URL(this[gc].baseUrl),i=r.host+r.pathname,s=null!=this[gc].ctx?{key:Wu.CTX,value:this[gc].ctx}:{key:Wu.TRACKING_ID,value:this[gc].trackingId},o=new ec({hostname:i});o.addQueryParameters([{key:Wu.PROTOCOL_VERSION,value:1},{key:Wu.HIT_TYPE,value:"event"},s,{key:Wu.CMP,value:this[gc].cmp},{key:Wu.CLIENT_ID,value:this[gc].clientId},{key:Wu.EVENT_CATEGORY,value:e},{key:Wu.EVENT_ACTION,value:t},{key:Wu.EVENT_LABEL,value:n.label},{key:Wu.EVENT_VALUE,value:n.value},{key:Wu.GDPR_APPLIES,value:n.gdpr},{key:Wu.GDPR_CONSENT,value:n.gdpr_consent}]);for(const[e,t]of Object.entries(n.customDimensions??{}))o.setCustomDimension(e,{value:t});for(const[e,t]of Object.entries(n.customMetrics??{}))o.setCustomMetric(e,{value:t});null!=n.redirectUrl&&o.addQueryParameter({key:Wu.REDIRECT_URL,value:n.redirectUrl});const a=n.cacheBusterMode??Ju.DATE;return o.setCacheBusterMode(a,n.customCacheBusterValue),o.build()}_mergeOptions(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{customDimensions:Object.assign({},...t.map(e=>e.customDimensions)),customMetrics:Object.assign({},...t.map(e=>e.customMetrics)),gdpr:this._findOption("gdpr",t),gdpr_consent:this._findOption("gdpr_consent",t),label:this._findOption("label",t),cacheBusterMode:this._findOption("cacheBusterMode",t),customCacheBusterValue:this._findOption("customCacheBusterValue",t)}}_findOption(e,t){const n=t.find(t=>null!=t[e]);return null!=n?n[e]:null}_getPixelInfo(e,t){const n={customDimensions:{},customMetrics:{},gdpr:this.gdprApplies,gdpr_consent:this.gdprConsent,label:null,cacheBusterMode:this[mc]?Ju.CUSTOM:null,customCacheBusterValue:this[mc]?Yr():null};return this[uc].forEach(e=>{try{e(n)}catch(e){}}),Object.assign(n.customDimensions,e),Object.assign(n.customMetrics,t),n}_getTimingInfo(e,t){const n=this[oc][e],r=this[oc][t];return null!=n&&n>0&&null!=r&&r>0?r-n:void 0}}const Ec={width:"100%",height:"100%",pointerEvents:"auto",position:"absolute",top:0,left:0},xc=Symbol("host"),Cc=Symbol("guest"),Tc=Symbol("config"),Oc=Symbol("tracking"),Ic=Symbol("hostInfo"),Mc=Symbol("guestInfo"),Vc=Symbol("contextInfo"),jc=Symbol("container"),Fc=Symbol("topContainer"),Lc=Symbol("containerSelector"),Dc=Symbol("videoPlaybackContext"),Rc=Symbol("vastChainInfo"),{pubSub:$c,phaser:Uc,init:Nc,setGuest:Bc,ensureContainer:zc,adParameters:Wc}=ns,qc={wrapperId:null,duration:null,skipOffset:null,mediaFiles:[],adParameters:null,plugins:[],flags:0},Hc=(e,t)=>{const n=(e.ownerDocument||document).createElement("div");return n.id=t,Object.assign(n.style,Ec),e.appendChild(n),n};class Gc extends kr{constructor(e){super(),this[xc]=e,this[Rc]=[]}get publishedEvents(){return this[xc][$c].published}get width(){return this._get("width")}get height(){return this._get("height")}get viewMode(){return this._get("viewMode")}get desiredBitrate(){return this._get("desiredBitrate")}get environmentVariables(){return this._get("environmentVariables")}get slot(){return this._get("slot")}get videoSlot(){return this._get("videoSlot")}get vastChain(){return this._get("vastChain")}get originVastUrl(){return this._get("originVastUrl")}get innermostVastUrl(){return this._get("innermostVastUrl")}get vastChainInfo(){return this[Rc]}addAdParamsVastChainInfo(e){e.split(",").forEach(e=>{const t=e.split(":");4===t.length&&t.push("0"),this[Rc].push(t)})}addVastChainInfo(e,t,n,r){let i;try{i=Dr(t)}catch(e){i=""}this[Rc].push([e,i,n,r?"1":"0","1"])}}class Qc extends kr{get mediaFile(){return this._get("mediaFile")}}class Yc{constructor(){this.uriBlacklistedForFriendlyIframe=null,this.imaSdkPresent=null,this.hasImaVpaidMediaFiles=null,this.hasNonImaVpaidMediaFiles=null,this.slotProvidedOnInitAd=null,this.videoSlotProvidedOnInitAd=null}}class Xc{constructor(){this.unmutedPlaybackAttempted=!1,this.mutedPlaybackAttempted=!1,this.playbackSuccessful=!1,this.mutedPlaybackDisabled=!1,this.adPaused=!1}toString(){return(this.unmutedPlaybackAttempted?"Y":"N")+(this.mutedPlaybackAttempted?"Y":"N")+(this.playbackSuccessful?"Y":"N")+(this.mutedPlaybackDisabled?"Y":"N")+(this.adPaused?"Y":"N")}}class Kc{constructor(e){this[xc]=e,this[Cc]=null,this[Ic]=new Gc(e),this[Mc]=new Qc,this[Vc]=new Yc,this[Tc]=Object.assign({},qc),this[Oc]=new Pc(e),this[jc]=null,this[Lc]=null,this[zc]=Qr(this[zc]),this[Wc]=null,this[Dc]=new Xc}get host(){return this[xc]}get guest(){return this[Cc]}get hostInfo(){return this[Ic]}get guestInfo(){return this[Mc]}get contextInfo(){return this[Vc]}get videoPlaybackContext(){return this[Dc]}get config(){return this[Tc]}get plugins(){return this[xc][Uc].plugins}get tracking(){return this[Oc]}get container(){return this[jc]}get topContainer(){return this[Fc]}get containerSelector(){return this[Lc]}get adParameters(){return this[Wc]}publish(e,t,n){return void 0===t&&(t=[]),void 0===n&&(n=null),this[xc]._publish(e,t,n)}track(){this[Oc].track(...arguments)}trackPixel(e,t){return e=function(e,t){return void 0===t&&(t={}),e.replace(li,(e,n)=>{const r=n.toLowerCase();return null!=ai[r]?ai[r](t):null!=t[r]?encodeURIComponent(""+t[r]):""})}(e,t),new ic(e).load()}trackError(){this[Oc].trackError(...arguments)}isFlagEnabled(e){return 0!==(this[Tc].flags&e)}[Nc](e){this[Tc]=Object.assign({},qc,this[Tc],e),this[Oc].configure(this[Tc])}[Bc](e){this[Cc]=e}[zc](){const{slot:e}=this[Ic],t=e.ownerDocument||document,n="vpaid-container-"+$e(),r=`${n}-0`,i=t.createElement("style");i.textContent=`#${r}, #${r} :not(html) { \n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 100%;\n  font: inherit;\n  vertical-align: baseline;\n  background: none;\n  opacity: 1;\n  border: none;\n  outline: none;\n  top: auto;\n  bottom: auto;\n  left: auto;\n  right: auto;\n }`,e.appendChild(i);const s=Hc(e,r);this[Fc]=s;let o=s,a="#"+s.id;for(let e=1;e<5;++e)o=Hc(o,`${n}-${e}`),a+=" #"+o.id;this[jc]=o,this[Lc]=a}}const Zc=Symbol("guest"),Jc=Symbol("guestVpaidVersion"),eh=Symbol("guestIframe"),th=Symbol("guestSubscriptions"),nh=Symbol("managingSlotSize"),rh=Symbol("hadError"),ih=Symbol("isLoaded"),{phaser:sh,pubSub:oh,runtime:ah,clickThroughUrl:lh,options:uh,internal:ch}=ns;class hh{constructor(e){void 0===e&&(e={}),this[sh]=new ii,this[oh]=new ps,this[Zc]=null,this[eh]=null,this[th]=[],this[nh]=!1,this[rh]=!1,this[ih]=!1,this[ah]=new Kc(this),this[uh]=e}subscribe(e,t,n){void 0===n&&(n=null),this[sh].runPhaseSync("subscribe",[e,t,n],()=>{this[oh].subscribe(e,t,n)},e=>this._onError(e,"subscribe"))}unsubscribe(e,t){this[sh].runPhaseSync("unsubscribe",[e,t],()=>{this[oh].unsubscribe(e,t)},e=>this._onError(e,"unsubscribe"))}handshakeVersion(e){return this[Jc]=e,"2.0"}initAd(e,t,n,r,i,s){this[ah].track("initAd"),this._initAdAsync(e,t,n,r,i,s)}resizeAd(e,t,n){const{hostInfo:r}=this[ah];try{r._putAll({width:e,height:t,viewMode:n}),this._phasedGuestCall("resizeAd",[e,t,n]).catch(e=>{this._onError(e,"resizeAd")})}catch(e){this._onError(e,"resizeAd")}}_createGuest(e){return new Promise(function(e,t){return t(new Error("Method is abstract"))})}_initAdAsync(e,t,n,r,i,s){return new Promise(function(o,a){let l,u;l=this[ah],({hostInfo:u}=l);var c=function(){try{return o()}catch(e){return a(e)}},h=function(e){try{return this._onError(e,"initAd"),c()}catch(e){return a(e)}}.bind(this);try{let o,a,d,p;if(u._putAll({width:e,height:t,viewMode:n,desiredBitrate:r,environmentVariables:s}),null==s)l.track("no-envvars");else{let n,r,i;({slot:n,videoSlot:r,sendErrorInfo:i}=s),u._putAll({slot:n,videoSlot:r}),this[oh].options.sendErrorInfo=!0===i,null==n?l.contextInfo.slotProvidedOnInitAd=!1:(l.contextInfo.slotProvidedOnInitAd=!0,this[nh]=null!=n.style&&(0===n.clientWidth||0===n.clientHeight),this._maybeResizeSlot(e,t)),l.contextInfo.videoSlotProvidedOnInitAd=null!=r}return Promise.resolve(this._createGuest({width:e,height:t,viewMode:n,desiredBitrate:r,creativeData:i,envVars:s})).then(function(i){try{return({iframe:o,vpaid:a,adParameters:d}=i),this[Zc]=a,this[eh]=o,this._guestSubscribeAll(),Promise.resolve(this._phasedGuestCall("handshakeVersion",[this[Jc]],!0)).then(function(i){try{return p={AdParameters:d},Promise.resolve(this._phasedGuestCall("initAd",[e,t,n,r,p,Object.assign({},s,{sendErrorInfo:!0})])).then(function(e){try{return c()}catch(e){return h(e)}},h)}catch(e){return h(e)}}.bind(this),h)}catch(e){return h(e)}}.bind(this),h)}catch(e){h(e)}}.bind(this))}_maybeResizeSlot(e,t){if(this[nh]){const{hostInfo:{slot:n}}=this[ah];Object.assign(n.style,{width:`${e}px`,height:`${t}px`})}}_publish(e,t,n){switch(void 0===t&&(t=[]),void 0===n&&(n=null),e){case be.AdError:{const[r]=t;if(!this._processErrorAndDecideOnPublish({error:r,method:n}))return Promise.resolve();if("guest"!==n)return this._phasedGuestEvent(e,[ji(r)]);break}case be.AdClickThru:{const[n]=t;if("string"!=typeof n)return this._phasedGuestEvent(e,[this[lh]]);break}}return this._phasedGuestEvent(e,t)}_guestSubscribeAll(){var e=this;const t=Object.keys(be).map(e=>be[e]);for(let n=0;n<t.length;++n){const r=t[n],i=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e._onGuestEvent(r,n)},s=[i,r];this._guestCall("subscribe",s),this[th].push(s)}}_guestUnsubscribeAll(){if(null==this[Zc])return;const e=this[th].splice(0);for(let t=0;t<e.length;++t)try{this._guestCall("unsubscribe",e[t])}catch(e){}}_onGuestEvent(e,t){switch(e){case be.AdLoaded:this._handleAdLoadedGuestEvent(t);break;case be.AdError:this._handleAdErrorGuestEvent(t);break;case be.AdMutedUnmutedPlayback:this._handleAdMutedUnmutedPlayback(t);break;default:this._publish(e,t,"guest")}}_handleAdMutedUnmutedPlayback(e){Object.assign(this[ah].videoPlaybackContext,e[0])}_handleAdLoadedGuestEvent(e){this[ih]=!0,this._publish(be.AdLoaded,e,"guest")}_handleAdErrorGuestEvent(e){const[t,n]=e;let r;r=this._guestIsInternalVpaid()?n:{message:"VAST error 901 due to AdError event"+(ze(t)?" (no AdError message)":`: ${t}`),code:901,cause:null==n?null:n},this._publish(be.AdError,[r.message,r],"guest")}_guestIsInternalVpaid(){return null!=this[Zc]&&!0===this[Zc][ch]}_guestCall(e,t){if(null==this[Zc])throw new Tr;if(!1===this[ih]&&"initAd"!==e&&"subscribe"!==e&&"unsubscribe"!==e&&"handshakeVersion"!==e)throw new Tr;"resizeAd"===e&&this._maybeResizeSlot(...t);const n=this[Zc][e];if("function"!=typeof n)throw new Ir(e);return n.apply(this[Zc],t)}_phasedGuestCallSync(e,t){var n=this;return this[sh].runPhaseSync(e,t,function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n._guestCall(e,r)},t=>this._onError(t,e,!0))}_phasedGuestCall(e,t,n){return new Promise(function(r,i){var s;s=this,void 0===n&&(n=!1);var o=function(){try{return r()}catch(e){return i(e)}},a=function(t){try{return this._onError(t,e,!0),o()}catch(e){return i(e)}}.bind(this);try{return Promise.resolve(this[sh].runPhase(e,t,function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const o=s._guestCall(e,r);return n?o:null},()=>this[rh])).then(function(e){try{return o()}catch(e){return a(e)}},a)}catch(e){a(e)}}.bind(this))}_phasedGuestEvent(e,t){return new Promise(function(n,r){var i;i=this;var s=function(){try{return e===be.AdStopped&&this._removeGuestIframe(),e===be.AdError&&this[uh].destroyAdOnAdError&&(this._unloadVideoSlot(),this._removeGuestIframe(),this._removeAdContainers()),n()}catch(e){return r(e)}}.bind(this),o=function(t){try{return this._onError(t,e),s()}catch(e){return r(e)}}.bind(this);try{return Promise.resolve(this[sh].runPhase(e,t,function(){var t=arguments;return new Promise(function(n,r){var s,o,a;if(Pe.indexOf(e)>=0)return Promise.resolve(i._dispose()).then(function(e){try{return l.call(this)}catch(e){return r(e)}}.bind(this),r);function l(){for(s=t.length,o=new Array(s),a=0;a<s;a++)o[a]=t[a];return i[oh].publish(e,o),n()}return l.call(this)})},()=>this[rh]&&Pe.indexOf(e)<0)).then(function(e){try{return s()}catch(e){return o(e)}},o)}catch(e){o(e)}}.bind(this))}_removeGuestIframe(){try{this[eh].parentNode.removeChild(this[eh])}catch(e){}this[eh]=null}_removeAdContainers(){try{this[ah].topContainer.parentNode.removeChild(this[ah].topContainer)}catch(e){}}_unloadVideoSlot(){try{const e=this[ah].hostInfo.videoSlot;e.pause(),e.removeAttribute("src"),e.load()}catch(e){}}_addPlugin(e){this[sh].addPlugin(e)}_processErrorAndDecideOnPublish(e,t){if(null!=e&&"GuestNotAvailableError"===e.name)return!1;const n=!this[rh];return n&&(this[rh]=!0,this._guestUnsubscribeAll()),n}_createErrorMessage(e,t,n){return void 0===n&&(n=!1),e instanceof Or?e.toString():n?`VAST error 901 due to error on ${t}${null==e||ze(e.message)?" (no error message)":`: ${e.message}`}`:null==e.message?"Unknown internal error":ji(e.message).substring(0,1e3)}_onError(e,t,n){if(void 0===n&&(n=!1),this._processErrorAndDecideOnPublish(e,t)){const r=this._createErrorMessage(e,t,n);this._phasedGuestEvent(be.AdError,[r,{message:r,code:null!=e.code?e.code:"901"}])}}_dispose(){return new Promise(function(e,t){if(this[uh].autoDisposeDisabled)return e();var n=function(){try{var n=function(){try{return e()}catch(e){return t(e)}},r=function(e){try{return n()}catch(e){return t(e)}};try{return Promise.resolve(new Promise(function(e,t){var n;function r(){if(Sc.length>0){let e;return e=Sc.splice(0),Promise.resolve(Promise.all(e)).then(function(e){try{return r}catch(e){return t(e)}},t)}return[1]}return(n=function(e){for(;e;){if(e.then)return void e.then(n,t);try{if(e.pop){if(e.length)return e.pop()?i.call(this):e;e=r}else e=e.call(this)}catch(e){return t(e)}}}.bind(this))(r);function i(){return e()}})).then(function(e){try{return n()}catch(e){return r()}},r)}catch(e){r()}}catch(e){return t(e)}},r=function(e){try{return n()}catch(e){return t(e)}};try{return Promise.resolve(this[sh].dispose()).then(function(e){try{return n()}catch(e){return r()}},r)}catch(e){r()}}.bind(this))}}var dh;(e=>{const t=Object.keys(ke);for(let n=0;n<t.length;n++){const r=t[n],{defaultValue:i,writable:s}=ke[r],o=ei(r);Mu(e,`get${o}`,i),s&&Vu(e,`set${o}`)}})(dh=hh.prototype),(e=>{const t=Object.keys(we).map(e=>we[e]);for(let n=0;n<t.length;++n){const r=t[n];Vu(e,r)}})(dh);const{runtime:ph,init:fh,setGuest:mh,adCompanions:gh}=ns,vh=Symbol("loaders");class yh extends hh{constructor(e,t){void 0===t&&(t={}),super(t),this[vh]=e,this._preprocessHashConfig()}getAdDuration(){return this._getPropertyValueWithConfigFallback("adDuration",this[ph].config.duration)}getAdWidth(){return this._getPropertyValueWithConfigFallback("adWidth",this[ph].hostInfo.width)}getAdHeight(){return this._getPropertyValueWithConfigFallback("adHeight",this[ph].hostInfo.height)}getAdCompanions(){return null!=this[gh]?this[gh]:super.getAdCompanions()}_getPropertyValueWithConfigFallback(e,t){const n=super[`get${ei(e)}`]();return n===ke[e].defaultValue&&null!=t?t:n}_createGuest(e){return new Promise(function(t,n){let r,i,s,o;return r=(e=>{const t=(e=>null==e||"string"==typeof e?e:e.AdParameters)(e);try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse AdParameters "${t}"`)}})(e.creativeData),this._loadConfig(r),this[ph].tracking.configured?Promise.resolve(this._loadMediaFile(r.mediaFiles,r.adParameters,e)).then(function(e){try{return({iframe:i,vpaid:s,adParameters:o}=e),this[ph][mh](s),t({iframe:i,vpaid:s,adParameters:o})}catch(e){return n(e)}}.bind(this),n):n(new Error("Invalid configuration"))}.bind(this))}_loadMediaFile(e,t,n){return new Promise(function(r,i){let s,o,a,l,u,c,h,d,p,f,m,g,v,y;return({width:s,height:o,desiredBitrate:a,envVars:{videoSlot:l}}=n),u=this[ph].contextInfo,c=Object.keys(this[vh]),h=function(e,t){return void 0===t&&(t=[We.vast,We.vpaid,We.video]),e.reduce((e,n)=>{const r=Ke(n);return t.indexOf(r)>=0&&(null==e[r]&&(e[r]=[]),e[r].push(n)),e},{})}(e,c),d=(e=>{let{[We.vpaid]:t}=e;return null==t?0:t.filter(e=>{let{uri:t}=e;return qr(t)}).length})(h),u.hasImaVpaidMediaFiles=d>0,u.hasNonImaVpaidMediaFiles=((e,t)=>{const n=e[We.vpaid];return null==n?Object.keys(e).length>0:n.length>t||Object.keys(e).length>1})(h,d),u.imaSdkPresent=(()=>{let e=null;try{e=window.parent.google.ima.VERSION}catch(e){}return"string"==typeof e})()||zr.test(window.location.href),this[ph].isFlagEnabled(2)&&(e=>{let{imaSdkPresent:t,hasImaVpaidMediaFiles:n,hasNonImaVpaidMediaFiles:r}=e;return t&&n&&r})(u)&&(e=>{const t=e[We.vpaid].filter(e=>{let{uri:t}=e;return!qr(t)});t.length>0?e[We.vpaid]=t:delete e[We.vpaid]})(h),p=((e,t,n,r,i)=>{const s=((e,t,n)=>{const r=wi(e*fi),i=wi(t*fi),s=wi(e),o=wi(t),a=wi(n);return[{filter:e=>{let{width:t,height:n,bitrate:l}=e;return t>=s&&t<=r&&n>=o&&n<=i&&l<=a},selector:yi},{filter:e=>{let{width:t,height:n,bitrate:r}=e;return t<=s&&n<=o&&r<=a},selector:bi},{filter:e=>{let{bitrate:t}=e;return isFinite(a)&&t<=a},selector:bi},{filter:()=>!0,selector:yi}]})(t,n,r);return((e,t,n)=>{const r=Object.keys(e).sort(Si);let i=null,s=0;for(;null==i&&s<r.length;){const o=r[s],a=e[o];i=(0,ki[o])(a,t,n),++s}return i})(e,s,i)})(h,s,o,a,l),null==p?i(new Or("No valid media files found",403)):(this[ph].guestInfo._put("mediaFile",p),f=Ke(p),m=this[vh][f],null==m?i(new Or(`Unsupported media file of type ${f}`,403)):(g=Li(),this[ph].tracking.addMetric(116,()=>g),Promise.resolve(m(this,p,t,n)).then(function(e){try{return v=e,y=Li(),this[ph].tracking.addMetric(117,()=>y),r(v)}catch(e){return i(e)}}.bind(this),i)))}.bind(this))}_preprocessHashConfig(){const e=jr();if(null==e)return;const t=(e=>{const t=e.indexOf("#");return t>=0?e.substr(t+1):null})(e.src);null!=t&&""!==t&&this._loadConfig(decodeURIComponent(t),!0)}_loadConfig(e,t){if(void 0===t&&(t=!1),null!=e){if(((e,t)=>{t||null==e.ctx&&null==e.wrapperId&&(e.wrapperId="12000000")})(e,t),this[ph][fh](e),Array.isArray(e.plugins)){const t={id:"vast-chain-tracking",config:{vastChainInfo:null!=e.customDimensions?e.customDimensions[116]:null}};e.plugins.push(t)}this._addPlugins(e.plugins)}}_addPlugins(e){if(null==e||this[ph].plugins.length>0)return;if(0===e.length)return;const t={};for(let n=0;n<e.length;++n){const{id:r,config:i}=e[n];let s;const o=r.indexOf(".");if(o<0)s=t[r]=i||{};else{const e=r.substr(0,o);s=Object.assign({},t[e],i)}try{this._createAndAddPlugin(r,s)}catch(e){console.warn(`Error creating plugin "${r}": ${e}`)}}}_createAndAddPlugin(e,t){const n=us.create(e,t,this[ph]);return this._addPlugin(n),n}}const bh={[We.vpaid]:(e,t,n,r)=>new Promise(function(i,s){let o,a,l,u,c,h,d;return({contextInfo:o}=e[Cu]),({uri:a}=t),l=o.uriBlacklistedForFriendlyIframe=(e=>Eu.some(t=>t.test(e)))(a),u=e[Cu].isFlagEnabled(4)||l?"inline":null,Promise.resolve(function(e,t,n){return new Promise(function(r,i){return void 0===n&&(n={}),r(("inline"===n.mode?jl:Fl)(e,t))})}(a,r.envVars.slot,{mode:u})).then(function(t){try{return({iframe:c,vpaid:h,time:d}=t),Promise.resolve(e[xu]._runStage("afterLoadVpaid",[{uri:a,time:d}])).then(function(e){try{return i({iframe:c,vpaid:h,adParameters:n})}catch(e){return s(e)}},s)}catch(e){return s(e)}},s)}),[We.video]:(e,t,n)=>new Promise(function(r,i){const{clickThroughUrl:s,skipOffset:o}=e[ku].config;null==e[Su]&&(e[Su]=s);const a=e[ku].isFlagEnabled(1),l=e[ku].isFlagEnabled(8);return r({vpaid:new Au(t.uri,Object.assign({},e[Pu],{skipOffset:o,noMutedAutoplayFallback:a,noPauseOnClickThrough:l})),adParameters:n})})};(()=>{const e=((e=>{const t=(e=>{const t=[];let n=e,r=0;for(;r++<10&&null!=n&&n!==Object.prototype;){const e=Object.getOwnPropertyDescriptors(n);t.push(...Object.keys(e).filter(e=>t.indexOf(e)<0)),n=Object.getPrototypeOf(n)}return t.filter(t=>Fr.indexOf(t)<0&&"function"==typeof e[t])})(e);for(let n=0;n<t.length;++n){const r=t[n];Lr(e,r)}})(yh),new yh(bh,{}));window.getVPAIDAd=()=>e})()}();
//# sourceMappingURL=https://ene-debug-scripts.doubleverify.io/vpaid/1.1.5/vpaid-transformer-no-csw.js.map
