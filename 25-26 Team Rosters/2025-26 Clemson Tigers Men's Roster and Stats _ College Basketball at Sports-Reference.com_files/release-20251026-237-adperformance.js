!function(){"use strict";function e(e){return null!=e}function t(t){return e(t)&&""!==t}function i(e){return"function"==typeof e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function s(e,t){let i=Math.floor(Math.random()*(t-e+1)+e);return i>t&&(i=t),i}function r(t,i,n){e(t)&&t.addEventListener?t.addEventListener(i,n,!1):e(t)&&t.attachEvent&&t.attachEvent("on"+i,n),t=null}function a(t,i,n){e(t)&&t.removeEventListener?t.removeEventListener(i,n,!1):e(t)&&t.detachEvent&&t.detachEvent("on"+i,n),t=null}const o=e=>{try{const i=e.charAt(0),n=e.substr(1).split(":"),s=n[0],r=t(n[1])&&parseInt(n[1],10);let a;switch(i){case"@":a=document.getElementsByTagName(s);break;case"#":a=document.getElementById(s);break;case"$":a=document.getElementsByName(s);break;case".":a=document.getElementsByClassName(s);break;default:a=document.getElementById(e)}return!a||"boolean"==typeof r||a instanceof HTMLElement?a:a.item(r)}catch(e){return null}};function c(e,t,i){return e?(i&&"string"==typeof t&&(t=function(e){if(!e)return"";return encodeURIComponent(e)}(t)),"&"+e+"="+t):""}function l(){return function(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length>=t)return e;const n=t-e.length,s=[];for(let e=0;e<n;e++)s.push("0");return i?s.join("")+e:e+s.join("")}(""+(e=>{const t=e.split(".");return 256*(256*(256*+t[0]+ +t[1])+ +t[2])+ +t[3]})(s(0,254)+"."+s(0,254)+"."+s(0,254)+"."+s(0,254)),10)+""+s(1e6,9999999)+Date.now().toString()}class d{constructor(e){this.execExistingFunctionsInQueue(e)}push(e){try{d.executeFunction(e)}catch(e){console.log("ERR",e)}}static executeFunction(e){i(e)&&e()}execExistingFunctionsInQueue(e){for(const t of e)this.push(t)}}const h="IMPRESSION_CLICKED",u="IMPRESSION_VIEWED";var m,p,g;!function(e){e[e.ABSTRACT=0]="ABSTRACT",e[e.UNLOAD=1]="UNLOAD",e[e.ACTIVE_ELEMENT=2]="ACTIVE_ELEMENT"}(m||(m={})),function(e){e[e.INTERSECTION_OBSERVER=3]="INTERSECTION_OBSERVER",e[e.DOM=4]="DOM",e[e.DFP=5]="DFP",e[e.DEFAULT=6]="DEFAULT",e[e.MRAID=7]="MRAID"}(p||(p={})),function(e){e[e.UNKNOWN=-1]="UNKNOWN"}(g||(g={}));const f="focus",w=200;var E;!function(e){e.VIEW="VIEW",e.CLICK="CLICK"}(E||(E={}));const b=new class{constructor(){this.trackerMap=new Map}add(t){return e(t)&&this.trackerMap.set(t.id,t),this}each(e){this.trackerMap.forEach((t,i)=>{e(t,i)})}find(t){const i=this.trackerMap.get(t);return e(i)?i:null}remove(e){return this.trackerMap.delete(e.id),this}values(){return[]}};var v;!function(e){e[e.TRACKING=0]="TRACKING",e[e.DISABLED=1]="DISABLED"}(v||(v={}));class T{constructor(e){this.eventName=e,this.listeners=new Array}addListener(e){const t={callback:e,once:arguments.length>1&&void 0!==arguments[1]&&arguments[1]};this.listeners.push(t)}removeListener(e){const t=this.findListener(e);if(t){const e=this.listeners.indexOf(t);this.listeners.splice(e,1)}}triggerListeners(e,t){this.listeners.slice(0).forEach(i=>{t||e?t?i.callback(void 0,t):e&&i.callback(e):i.callback(),i.once&&this.removeListener(i.callback)})}findListener(e){return this.listeners.find(t=>t.callback===e)}}class M extends class{constructor(){this.events=new Map}on(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.events.get(e);n||(n=new T(e),this.events.set(e,n)),n.addListener(t,i)}off(e,t){const i=this.events.get(e);i&&(i.removeListener(t),0===i.listeners.length&&this.events.delete(e))}emit(e,t,i){const n=this.events.get(e);n&&(void 0===t&&void 0===i?n.triggerListeners():void 0===t||"number"==typeof t||t instanceof Error||void 0!==i?"number"==typeof t&&void 0===i?setTimeout(()=>{n.triggerListeners()},t):void 0===t||"number"==typeof t||t instanceof Error||"number"!=typeof i?void 0!==t&&"number"!=typeof t&&t instanceof Error&&void 0===i?n.triggerListeners(t,void 0):void 0!==t&&"number"!=typeof t&&t instanceof Error&&"number"==typeof i&&setTimeout(()=>{n.triggerListeners(t,void 0)},i):setTimeout(()=>{n.triggerListeners(void 0,t)},i):n.triggerListeners(void 0,t))}destroy(e){this.events.get(e)&&this.events.delete(e)}}{constructor(e,t){super(),this.stateMap=new Map,this.detectorMap=new Map,this.id=t;for(const t of e)this.stateMap.set(t.type,v.TRACKING),this.detectorMap.set(t.type,t),t.startTracking(e=>{this.isActive(t.type)&&(t.isOneTimeEvent()&&(t.disable(this.id),this.stateMap.set(t.type,v.DISABLED)),this.emit(t.event,e))},this.id)}getMeta(e){var t;return(null===(t=this.detectorMap.get(e))||void 0===t?void 0:t.getMeta(this.id))||{strategyUsed:g.UNKNOWN}}killType(t){this.stateMap.set(t,v.DISABLED);const i=this.detectorMap.get(t);e(i)&&i.stopTracking(this.id)}isActive(e){return this.stateMap.get(e)===v.TRACKING}kill(e){for(const t of e)this.killType(t)}}class I{constructor(){this.trackerTypeToDetectorsMap=new Map}static getDetectorByPreference(t,i){for(const n of t)if(e(n)&&n.isSupported(i))return n;return null}getDetector(t,i){if(e(i)&&e(this.trackerTypeToDetectorsMap)){const n=this.trackerTypeToDetectorsMap.get(t);if(e(n))return I.getDetectorByPreference(n,i)}return null}setupDetectors(e){for(const t of e){const e=t.type,i=this.trackerTypeToDetectorsMap.get(e)||[];i.push(t),this.trackerTypeToDetectorsMap.set(t.type,i)}}getNewTracker(t,i){let n=b.find(i);null!==n&&n.kill(t);const s=[];for(const n of t){const t=this.getDetector(n,i);e(t)&&s.push(t)}return 0===s.length?null:(n=new M(s,i),b.add(n),n)}getTracker(e){return b.find(e)}removeTracker(t,i){e(t)&&(b.remove(t),t.kill(i))}}const C=new I;function k(){return document[function(){if(void 0!==document.hidden)return"hidden";if(void 0!==document.mozHidden)return"mozHidden";if(void 0!==document.msHidden)return"msHidden";if(void 0!==document.webkitHidden)return"webkitHidden";return""}()]}const L=242e3,V=100,y=50,A=.5,S=1e3,O=30,N=.3,F=1e3,D=50,R=2e3,U=()=>{};class _{constructor(e){this.onTime=(new Date).getTime(),this.onTimeCount=0,this.status=1,this.upperBound=e,this.countdown=e,this.timerId=l()}get id(){return this.timerId}get onCount(){return this.onTimeCount}getElapsedTime(){return this.isTimerOn()?this.upperBound-this.getRemainingCountdownTime():this.upperBound-this.countdown}getRemainingCountdownTime(){const e=(new Date).getTime()-this.onTime;return this.countdown-e}on(){return this.isTimerOn()||(this.status=0,this.timeoutId=setTimeout(()=>{this.countdownComplete()},this.countdown),this.onTime=(new Date).getTime()),this.onTimeCount++,this.countdown}pause(){return this.isTimerOn()&&(clearTimeout(this.timeoutId),this.countdown=this.getRemainingCountdownTime(),this.status=2),this.countdown}time(){return this.countdown}isTimerOn(){return 0===this.status}countdownComplete(){this.callback(!0),this.callback=U}}function B(e){return e.clientWidth*e.clientHeight>=L?1:0}function P(t,i,n){const s=t.get(i);if(!e(s))return{strategyUsed:n};const r=s.getElapsedTime();return{inViewCount:s.onCount,inViewTime:r,strategyUsed:n}}function H(t,i){let n=t.get(i);return e(n)||(n=new _(1e9),t.set(i,n)),n}function K(e){switch(B(e)){case 0:return S;case 1:return F;case 2:return R;default:return 1e3}}class W{constructor(){this.mraidEventsSet=!1}static setMraidScreenVisibility(t){e(window.mraid)&&i(window.mraid.isViewable)&&t(window.mraid.isViewable())}setMraidEvents(t){this.mraidEventsSet||e(window.mraid)&&e(window.mraid.addEventListener)&&(parseInt(window.mraid.getVersion())>=3?window.mraid.addEventListener("exposureChange",(e,i,n)=>{t(e>0)}):window.mraid.addEventListener("viewableChange",e=>{t(e)}))}setChecksForInApp(e){W.setMraidScreenVisibility(e),this.setMraidEvents(e)}}const x=new W;const G=new class{constructor(){this.switchListeners=[],this.isListening=!1}visibilityChangeEventListener(){const e=!k();this.notifyListeners(e)}notifyListeners(e){this.switchListeners.forEach(t=>{t.listener(e,t.element)})}refreshTimeout(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;return n=>{clearTimeout(t),t=setTimeout(()=>e(n),i)}}track(e){this.switchListeners.push({element:e.element,listener:e.listener})}listen(){if(this.isListening)return;this.isListening=!0;const e=this.refreshTimeout(this.visibilityChangeEventListener.bind(this),w);r(window,void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":"",e),r(window,f,e)}};function Y(e,t){G.track({element:t,listener:i=>{if(!i){H(e,t).pause()}}})}const z=(e,t,n)=>{const s=i(n)?n:Date.now;let r=s();return function(){const i=s();if(i-r>=e){r=i;for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];t.apply(null,a)}}};const j=new class{constructor(){this.elementInViewMap=new Map,this.elementDebounceIdMap=new Map,this.isScreenVisible=!0,this.targetViewTimerMap=new Map,this.isSupported()&&(this.setObserverForAds(),this.setObserverForLargeAds(),x.setChecksForInApp(e=>{this.mraidCallback(e)}))}setObserverForLargeAds(){const e={threshold:N};this.IOForLargeAds=new window.IntersectionObserver(this.handlerForLargeAds.bind(this),e)}setObserverForAds(){const e={threshold:A};this.IOForAds=new window.IntersectionObserver(this.handlerForAds.bind(this),e)}handlerForAds(e,t){e.forEach(e=>{const t=e.target,i=H(this.targetViewTimerMap,t);e.intersectionRatio>=A?(this.elementInViewMap.set(t,!0),this.checkForViewableIABTime(t,S),i.on()):(this.elementInViewMap.set(t,!1),i.pause())})}handlerForLargeAds(e,t){e.forEach(e=>{const t=e.target,i=H(this.targetViewTimerMap,t);e.intersectionRatio>=N?(this.elementInViewMap.set(t,!0),this.checkForViewableIABTime(t,F),i.on()):(this.elementInViewMap.set(t,!1),i.pause())})}checkForViewableIABTime(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;const n=function(t,i,n){return e(t)&&clearInterval(t),window.setTimeout(n,i)}(this.elementDebounceIdMap.has(t)&&this.elementDebounceIdMap.get(t)||null,i,this.postThresholdTimeCheck(t));this.elementDebounceIdMap.set(t,n)}postThresholdTimeCheck(e){return()=>{this.elementInViewMap.has(e)&&this.elementInViewMap.get(e)&&i(this.genericCallbackForElements)&&this.isScreenVisible&&this.genericCallbackForElements(e)}}mraidCallback(e){if(this.isScreenVisible=e,this.isScreenVisible)for(const[e,t]of this.elementInViewMap)t&&this.checkForViewableIABTime(e)}getMeta(e){return P(this.targetViewTimerMap,e,p.INTERSECTION_OBSERVER)}set fireCallbackForElement(e){this.genericCallbackForElements=e}observe(e){const t=B(e);switch(Y(this.targetViewTimerMap,e),t){case 0:this.IOForAds.observe(e);break;case 1:this.IOForLargeAds.observe(e)}}unobserve(e){switch(B(e)){case 0:this.IOForAds.unobserve(e);break;case 1:this.IOForLargeAds.unobserve(e)}this.elementInViewMap.set(e,!1),this.targetViewTimerMap.delete(e)}isSupported(){return i(window.IntersectionObserver)}};let X,q,Q,$,J;function Z(){const e={width:(t=ae).innerWidth,height:t.innerHeight};var t;q={width:e.width,height:e.height}}function ee(t){if(e(t)&&t&&Z(),i(X)){X().forEach(te)}}function te(t){const i=J(),n=i.get(t.id);if(!e(n))return;const s=q,r=ie(t,s);if(n.previousStatus===r)return;e(n.timerId)&&clearTimeout(n.timerId);const a=H($(),t);let o=null;if(r){a.on();const e=()=>{ie(t,s)&&Q(t)},i=K(t);o=window.setTimeout(e,i)}else a.pause();i.set(t.id,{previousStatus:r,timerId:o})}function ie(e,t){switch(B(e)){case 0:return function(e,t){return se(e,t)>=y}(e,t);case 1:return function(e,t){return se(e,t)>=O}(e,t);default:return!1}}function ne(e){return e.pageYOffset&&{X:e.pageXOffset,Y:e.pageYOffset}||{X:0,Y:0}}function se(t,i){if(!(e(i)&&e(i.width)&&e(i.height)))return 0;const n=function(e){const t=ne(ae),i=ae;let n=window,s=e,r=0,a=0;do{const e=s.getBoundingClientRect();if(n===i){const t=ne(n);r+=e.left+t.X,a+=e.top+t.Y;break}r+=e.left,a+=e.top,n.frameElement&&(s=n.frameElement),n=n.parent}while(n&&n.document);return{height:e.clientHeight,left:r-t.X,top:a-t.Y,width:s.clientWidth,x:r-t.X,y:a-t.Y}}(t),s=n.left,r=n.top,a=n.width,o=n.height;return re(0,i.width,s,s+a)*re(0,i.height,r,r+o)/(a*o)*100}function re(e,t,i,n){return e>=t||i>=n||n<=e||i>=t?0:e<=i&&t>=n?n-i:e>=i&&t<=n?t-e:e>i&&t>n?n-e:e<i&&t<n?t-i:0}const ae=function(){let e=window;if(window.top){const t=window.top;try{let i=0;if(t)for(;e!==t&&i<20;){e.parent.innerWidth;e=e.parent,i++}}catch(e){}}return e}();const oe=z(V,(function(){ee()}));const ce=z(V,(function(){ee(!0)}));class le{constructor(){var e,t,i,n;this.isScreenVisible=!0,this.targetViewTimerMap=new Map,this.elementVisibilityStateMap=new Map,this.elementList=[],this.tracking=!1,e=this.getElementList.bind(this),t=this.fireCallback.bind(this),i=this.getTargetViewTimerMap.bind(this),n=this.getElementVisibilityStateMap.bind(this),X=e,Q=t,Z(),$=i,J=n,x.setChecksForInApp(e=>{this.mraidCallback(e)})}static setupEventHandlers(){r(window,"scroll",oe),r(window,"resize",ce)}static unsetEventHandlers(){a(window,"scroll",oe),a(window,"resize",ce)}getElementList(){return this.elementList}getMeta(e){return P(this.targetViewTimerMap,e,p.DOM)}getTargetViewTimerMap(){return this.targetViewTimerMap}getElementVisibilityStateMap(){return this.elementVisibilityStateMap}fireCallback(t){e(this.genericCallbackForElements)&&this.isScreenVisible&&this.genericCallbackForElements(t)}mraidCallback(e){this.isScreenVisible=e,this.isScreenVisible&&oe()}set fireCallbackForElement(e){this.genericCallbackForElements=e}observe(e){this.tracking||(this.tracking=!0,le.setupEventHandlers()),this.elementVisibilityStateMap.set(e.id,{previousStatus:!1,timerId:null}),this.elementList.push(e),Y(this.targetViewTimerMap,e),ce(),oe()}unobserve(e){if(this.elementList.includes(e)){const t=this.elementList.indexOf(e);this.elementList.splice(t,1),0===this.elementList.length&&(this.tracking=!1,le.unsetEventHandlers())}this.targetViewTimerMap.delete(e)}static isTopWindow(){try{return"object"==typeof window&&"object"==typeof window.top&&window===window.top}catch(e){return!1}}isSupported(){return le.isTopWindow()}}const de=new le;const he=new class{constructor(){}set fireCallbackForElement(e){this.genericCallbackForElements=e}observe(e){}unobserve(e){}isSupported(){return!0}getMeta(e){return{strategyUsed:p.DEFAULT}}};class ue{constructor(){this.name="DOM",this.type=E.VIEW,this.event=u,this.elementIdMap=new Map,this.elementCallbackMap=new Map,this.detectorStrategy=ue.getSelectedStrategy(),this.detectorStrategy.fireCallbackForElement=this.fireCallbackForElement.bind(this),this.setupEventHandlers()}disable(t){const i=this.elementIdMap.get(t);e(i)&&this.elementCallbackMap.has(i)&&this.elementCallbackMap.delete(i)}isSupported(t){const i=o(t);return!!(e(i)&&i instanceof Element)&&(this.elementIdMap.set(t,i),j.isSupported()||de.isSupported())}isOneTimeEvent(){return!0}getMeta(t){const i=this.elementIdMap.get(t);return e(i)&&this.detectorStrategy?this.detectorStrategy.getMeta(i):{strategyUsed:g.UNKNOWN}}startTracking(t,i){const n=this.elementIdMap.get(i);e(n)&&(this.elementCallbackMap.set(n,t),this.detectorStrategy.observe(n))}stopTracking(t){this.disable(t);const i=this.elementIdMap.get(t);e(i)&&e(this.detectorStrategy)&&this.detectorStrategy.unobserve(i)}fireCallbackForElement(e){if(this.elementCallbackMap.has(e)){const t=this.elementCallbackMap.get(e);i(t)&&t()}}static getSelectedStrategy(){return j.isSupported()?j:de.isSupported()?de:he}setupEventHandlers(){G.listen()}}const me=new ue;let pe,ge,fe=!1;function we(t,i){if(!e(i))return;const n=function(e){switch(B(e)){case 0:return y;case 1:return O;case 2:return D}}(i);e(n)&&function(e,t){if(fe===e)return;fe=e,clearTimeout(pe);const i=H(ge(),t);fe?(pe=window.setTimeout(()=>{fe&&be.elementViewedCallback()},K(t)),i.on()):i.pause()}(t>=n,i)}const Ee=z(V,(e,t)=>we(e,t));const be=new class{constructor(){var e;this.event=u,this.name="MRAID",this.type=E.VIEW,this.targetViewTimerMap=new Map,this.elementIdMap=new Map,this.elementCallbackMap=new Map,this.eventAttached=!1,e=this.getTargetViewTimerMap.bind(this),ge=e}disable(e){this.deleteFromElementCallbackMap(e)}getTargetViewTimerMap(){return this.targetViewTimerMap}isOneTimeEvent(){return!0}isSupported(t){const i=o(t);return e(i)&&i instanceof Element&&this.elementIdMap.set(t,i),e(window.mraid)&&e(window.mraid.addEventListener)&&parseInt(window.mraid.getVersion())>=3}getMeta(t){const i=this.elementIdMap.get(t);return e(i)?P(this.targetViewTimerMap,i,p.MRAID):{strategyUsed:p.MRAID}}elementViewedCallback(){this.elementCallbackMap.forEach((e,t)=>{i(e)&&e()})}setElementCallbackMap(e,t){this.elementCallbackMap.set(e,t)}deleteFromElementCallbackMap(e){this.elementCallbackMap.delete(e)}startTracking(e,t){if(this.setElementCallbackMap(t,e),this.eventAttached)return;const i=this.elementIdMap.get(t),n=e=>{Ee(e,i)},s=()=>{window.mraid.addEventListener("exposureChange",n)};"loading"===window.mraid.getState()?window.mraid.addEventListener("ready",s):s(),this.eventAttached=!0}stopTracking(e){this.disable(e),this.eventAttached&&0===this.elementCallbackMap.size&&(this.eventAttached=!1,window.mraid.removeEventListener("exposureChange",Ee));const t=this.elementIdMap.get(e);t&&this.targetViewTimerMap.delete(t)}},ve="hidden";var Te,Me,Ie;function Ce(e,t,i,n){try{t(e,i,n)}catch(e){}}!function(e){e[e.MOUSE_IN_TARGET=0]="MOUSE_IN_TARGET",e[e.CLICK_IN_TARGET=1]="CLICK_IN_TARGET"}(Te||(Te={})),function(e){e.COMPOSITE_CLICK="COMPOSITE_CLICK",e.ACTIVE_ELEMENT_CLICK="ACTIVE_ELEMENT_CLICK",e.HEURISTIC_CLICK_DETECTOR="HEURISTIC_CLICK_DETECTOR "}(Me||(Me={})),function(e){e.BLUR="blur",e.MOUSE_DOWN="mousedown",e.MOUSE_ENTER="mouseenter",e.MOUSE_LEAVE="mouseleave",e.VISIBILITY_CHANGE="visibilitychange",e.BEFORE_UNLOAD="beforeunload"}(Ie||(Ie={}));class ke{constructor(e,t){this.type=E.CLICK,this.event=h,this.supportedElemMap=new Map,this.elementCallbackMap=new Map,this.name=e,this.allEventHandlers=t;for(const e of this.allEventHandlers)e.fireCallbackForElement=this.onValidClickNotify.bind(this)}disable(t){const i=this.supportedElemMap.get(t);e(i)&&this.elementCallbackMap.delete(i)}onValidClickNotify(e,t){const i=this.elementCallbackMap.get(e);"function"==typeof i&&i(t)}static getSupportedElement(t){var i;const n=o(t);return n&&n instanceof Element?null!==(i=function(t){const i=t.getElementsByTagName("iframe");let n,s=0;for(const e of i){const t=e.getBoundingClientRect().height;s<t&&(s=t,n=e)}return e(n)?n:null}(n))&&void 0!==i?i:n:null}getMeta(e){return{strategyUsed:g.UNKNOWN}}isOneTimeEvent(){return!0}isSupported(e){const t=ke.getSupportedElement(e);return null!==t&&(this.supportedElemMap.set(e,t),!0)}startTracking(t,i){const n=this.supportedElemMap.get(i);if(e(n)){this.elementCallbackMap.set(n,t);for(const e of this.allEventHandlers)e.observe(n)}}stopTracking(t){this.disable(t);const i=this.supportedElemMap.get(t);if(e(i))for(const e of this.allEventHandlers)e.unobserve(i)}}const Le=new ke(Me.ACTIVE_ELEMENT_CLICK,[new class{constructor(){this.eventsAttached=!1,this.getValidClickElement=()=>{const t=document.activeElement;return e(t)&&t instanceof HTMLElement?this.elementSet.has(t)?t:function(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,s=t,r=0;for(;s&&r<n;){const t=s.parentElement;if(!e(t))break;if(i.has(t))return t;s=t,r++}return null}(t,this.elementSet):null},this.visibilityChangeHandler=e=>{document.visibilityState===ve&&this.triggerClickTrackingIfValid(e.type)},this.triggerClickTrackingIfValid=t=>{const i=this.getValidClickElement();e(i)&&this.fireCallbackForElement(i,{strategyUsed:m.ACTIVE_ELEMENT,eventName:t})},this.beforeUnloadHandler=e=>{this.triggerClickTrackingIfValid(e.type)},this.elementSet=new Set}isSupported(){return!0}getMeta(e){return{strategyUsed:m.ACTIVE_ELEMENT}}observe(e){this.elementSet.add(e),this.eventsAttached||(Ce(window,r,Ie.BEFORE_UNLOAD,this.beforeUnloadHandler),Ce(document,r,Ie.VISIBILITY_CHANGE,this.visibilityChangeHandler),this.eventsAttached=!0)}unobserve(e){this.elementSet.delete(e),0===this.elementSet.size&&this.eventsAttached&&(Ce(window,a,Ie.BEFORE_UNLOAD,this.beforeUnloadHandler),Ce(document,a,Ie.VISIBILITY_CHANGE,this.visibilityChangeHandler),this.eventsAttached=!1)}}]);var Ve;!function(e){e[e.VIEW=1]="VIEW",e[e.CLICK=2]="CLICK"}(Ve||(Ve={}));const ye={[E.VIEW]:Ve.VIEW,[E.CLICK]:Ve.CLICK},Ae={[E.VIEW]:u,[E.CLICK]:h},Se={adUnitPath:"aupath",isPageVisible:"ispv",strategyUsed:"apstrat",inViewTime:"invwtm",inViewCount:"invwct",eventName:"domen"};class Oe{config;globalAdPerfPixel;constructor(e,i,s){const r={};for(let s=0;s<e.length;s++){let a=e[s];if(t(a)&&(r[a]=[],n(i)&&i.length>0)){let e=i[s];n(e)&&e.length>0&&(r[a]=e)}}this.config=r,this.globalAdPerfPixel=s}getValue(e){return this.config[e]}isTrackingEnabled(t){const i=this.getValue(t);return e(i)&&n(i)}getTrackingUrls(i){const n={customUrls:this.getValue(i),globalAdPerfPixel:""};return t(this.globalAdPerfPixel)&&(n.globalAdPerfPixel=this.globalAdPerfPixel+function(t){let i="";const n=ye[t];return e(n)&&(i=c("evttyp",n,!1)),i}(i)),n}}const Ne={enrichURL(t,i){if(!e(i))return t;const n=new URL(t);for(const[t,s]of Object.entries(i)){const i=Se[t];e(i)&&e(s)&&n.searchParams.append(i,String(s))}return n.toString()},sendViaBeacon(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!(!e(navigator.sendBeacon)||!i(navigator.sendBeacon))&&navigator.sendBeacon(t,n)},fireViaImageRequests(e){e.forEach(e=>{(new Image).src=e})},submit:e=>t=>{const i=Ne.enrichURL(e.globalAdPerfPixel,t);Ne.sendViaBeacon(i)?Ne.fireViaImageRequests(e.customUrls):Ne.fireViaImageRequests([i,...e.customUrls])}};function Fe(i,n){if(!e(n)||!i.isTrackingEnabled(E.VIEW))return;const s=function(e){if(!t(e.globalAdPerfPixel))return e;const i=new URL(e.globalAdPerfPixel);return i.searchParams.set("evttyp","3"),e.globalAdPerfPixel=i.toString(),e}(i.getTrackingUrls(E.VIEW)),r=Ne.submit(s);window.addEventListener("pagehide",e=>{const t=n.getMeta(E.VIEW);r(t)})}window.adPerf=new class{allowedTrackers=[];eventCallbackMap=(()=>new Map)();constructor(){C.setupDetectors([be,me,Le])}track(i,n,s){let r="https://hblg-nv.media.net/log?logid=kfke&evtid=adpvlog";t(window.adPerformancePixel)&&(r=window.adPerformancePixel);const a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return void 0!==window.mraid&&(e+="&mraid_version="+window.mraid.getVersion()),t(i)?t(e)?i+e:i:""}(window.logParams,r),o=new Oe(n,s,a);this.processForATrackerType(o,E.VIEW),this.processForATrackerType(o,E.CLICK);const c=C.getNewTracker(this.allowedTrackers,i);if(Fe(o,c),e(c)&&this.eventCallbackMap.size>0){for(const[e,{callback:t,oneTimeEvent:i}]of this.eventCallbackMap)c.on(e,(e,i)=>{t(i)},i);return!0}return!1}processForATrackerType(e,t){if(e.isTrackingEnabled(t)){this.allowedTrackers.push(t);const i=e.getTrackingUrls(t),n={callback:Ne.submit(i),oneTimeEvent:t!==E.CLICK};this.eventCallbackMap.set(Ae[t],n)}}},window._adp=new d(window._adp||[])}();
